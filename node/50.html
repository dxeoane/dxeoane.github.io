<!DOCTYPE html>
<html lang="es" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ og: http://ogp.me/ns# rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema#">
<head>
  <link rel="profile" href="http://www.w3.org/1999/xhtml/vocab" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/sites/delphi.jmrds.com/themes/bootstrap/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="shortlink" href="/node/50" />
<link rel="canonical" href="/node/50" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
  <title>PrintTest | La web de Seoane</title>
  <style>
@import url("/modules/system/system.base.css?");
</style>
<style>
@import url("/modules/field/theme/field.css?");
@import url("/modules/node/node.css?");
</style>
<style>
@import url("/sites/delphi.jmrds.com/modules/geshifilter/geshifilter.css?");
</style>
<link type="text/css" rel="stylesheet" href="//cdn.jsdelivr.net/bootstrap/3.3.5/css/bootstrap.css" media="all" />
<style>
@import url("/sites/delphi.jmrds.com/themes/bootstrap/css/3.3.5/overrides.min.css?");
</style>
  <!-- HTML5 element support for IE6-8 -->
  <!--[if lt IE 9]>
    <script src="https://cdn.jsdelivr.net/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <script src="/sites/delphi.jmrds.com/modules/jquery_update/replace/jquery/1.10/jquery.min.js?v=1.10.2"></script>
<script src="/misc/jquery.once.js?v=1.2"></script>
<script src="/misc/drupal.js?"></script>
<script src="//cdn.jsdelivr.net/bootstrap/3.3.5/js/bootstrap.js"></script>
<script src="/sites/delphi.jmrds.com/files/languages/es_sB9mP1iixuFRbyZKZVySK7xrSW_2-LRj1vNEXyqwOu8.js?"></script>
<script>jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"bootstrap","theme_token":"Ha48qpdayQOwaXgIsDN9LCInzKR5X-7dpaLrypBTIO0","js":{"sites\/delphi.jmrds.com\/themes\/bootstrap\/js\/bootstrap.js":1,"sites\/delphi.jmrds.com\/modules\/jquery_update\/replace\/jquery\/1.10\/jquery.min.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"\/\/cdn.jsdelivr.net\/bootstrap\/3.3.5\/js\/bootstrap.js":1,"public:\/\/languages\/es_sB9mP1iixuFRbyZKZVySK7xrSW_2-LRj1vNEXyqwOu8.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"sites\/delphi.jmrds.com\/modules\/geshifilter\/geshifilter.css":1,"\/\/cdn.jsdelivr.net\/bootstrap\/3.3.5\/css\/bootstrap.css":1,"sites\/delphi.jmrds.com\/themes\/bootstrap\/css\/3.3.5\/overrides.min.css":1}},"bootstrap":{"anchorsFix":"0","anchorsSmoothScrolling":"0","formHasError":1,"popoverEnabled":"1","popoverOptions":{"animation":1,"html":0,"placement":"right","selector":"","trigger":"click","triggerAutoclose":1,"title":"","content":"","delay":0,"container":"body"},"tooltipEnabled":"1","tooltipOptions":{"animation":1,"html":0,"placement":"auto left","selector":"","trigger":"hover focus","delay":0,"container":"body"}}});</script>
</head>
<body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-50 node-type-article">
  <div id="skip-link">
    <a href="#main-content" class="element-invisible element-focusable">Pasar al contenido principal</a>
  </div>
    <header id="navbar" role="banner" class="navbar container navbar-default">
  <div class="container">
    <div class="navbar-header">
              <a class="logo navbar-btn pull-left" href="/" title="Inicio">
          <img src="/sites/delphi.jmrds.com/themes/bootstrap/logo.png" alt="Inicio" />
        </a>
      
              <a class="name navbar-brand" href="/" title="Inicio">La web de Seoane</a>
      
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
          </div>

          <div class="navbar-collapse collapse" id="navbar-collapse">
        <nav role="navigation">
                      <ul class="menu nav navbar-nav"><li class="first leaf"><a href="/" title="">Inicio</a></li>
<li class="leaf"><a href="/search/node" title="">Buscar</a></li>
<li class="leaf"><a href="/rss.xml" title="">RSS</a></li>
<li class="leaf"><a href="/node/26" title="">Contacto</a></li>
<li class="last leaf"><a href="/user/login" title="">Login</a></li>
</ul>                                      </nav>
      </div>
      </div>
</header>

<div class="main-container container">

  <header role="banner" id="page-header">
    
      </header> <!-- /#page-header -->

  <div class="row">

    
    <section class="col-sm-12">
                  <a id="main-content"></a>
                    <h1 class="page-header">PrintTest</h1>
                                                          <div class="region region-content">
    <section id="block-system-main" class="block block-system clearfix">

      
  <article id="node-50" class="node node-article node-promoted clearfix" about="/node/50" typeof="sioc:Item foaf:Document">
    <header>
            <span property="dc:title" content="PrintTest" class="rdf-meta element-hidden"></span><span property="sioc:num_replies" content="42" datatype="xsd:integer" class="rdf-meta element-hidden"></span>        <span class="submitted">
            <span property="dc:date dc:created" content="2009-02-03T22:41:19+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" about="/user/1" typeof="sioc:UserAccount" property="foaf:name" datatype="">admin</span> el Mar, 02/03/2009 - 22:41</span>    </span>
      </header>
    <div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Esta herramienta surgió de la necesidad de comprobar el funcionamiento de impresoras de tickets, es decir, que corta bien, que imprime el logo correcto, etc. Su funcionamiento es realmente simple, se selecciona la impresora, se escribe la secuencia de escape y se pulsa el botón "Enviar".  No importa si la impresora es serie, paralelo, usb o es una impresora compartida desde otro equipo, el único requisito es que este instalada, aunque sea como una impresora "Genérica / Solo texto".</p>
<!--break--><p></p><center><img src="/sites/delphi.jmrds.com/imagenes/Stories/printtest.jpg" /></center>
<p>Aquí dejo un ejemplo de algunas secuencias de escape (pueden variar de una impresora a otra):</p>
<div class="geshifilter">
<pre class="text geshifilter-text" style="font-family:monospace;">Para que la impresora emita un pitido
\x1B@\x0A\x0D\x1B\x07\x0A\x0D
 
Para que corte el papel
\x1B@\x0A\x0D\x1Bi\x0A\x0D
 
Para abrir el cajon de monedas
\x1B@\x0A\x0D\027\112\000\100\250\x0A\x0D
 
Para que escriba "Hola mundo"  
\x1B@\x0A\x0DHola mundo\x0A\x0D</pre></div>
<p>Los caracteres especiales se escriben precedidos por el carácter "\" seguido de 3 cifras decimales o de "x" y dos cifras hexadecimales. Así el carácter ESC se escribe "\x1B" o "\027", y el retorno de carro "\x0D" o "\013".</p>
<p>El código de este programa, en delphi, es el siguiente:</p>
<div class="geshifilter">
<pre class="delphi geshifilter-delphi" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">unit</span> ufrmMain<span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">interface</span>
 
<span style="color: #000000; font-weight: bold;">uses</span>
  Windows<span style="color: #000066;">,</span> Messages<span style="color: #000066;">,</span> SysUtils<span style="color: #000066;">,</span> Variants<span style="color: #000066;">,</span> Classes<span style="color: #000066;">,</span> Graphics<span style="color: #000066;">,</span> Controls<span style="color: #000066;">,</span> Forms<span style="color: #000066;">,</span>
  Dialogs<span style="color: #000066;">,</span> StdCtrls<span style="color: #000066;">,</span> Menus<span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">type</span>
  TfrmMain <span style="color: #000066;">=</span> <span style="color: #000000; font-weight: bold;">class</span><span style="color: #000066;">(</span>TForm<span style="color: #000066;">)</span>
    txtSecuencia<span style="color: #000066;">:</span> TEdit<span style="color: #000066;">;</span>
    cmbPrinters<span style="color: #000066;">:</span> TComboBox<span style="color: #000066;">;</span>
    Label1<span style="color: #000066;">:</span> TLabel<span style="color: #000066;">;</span>
    Enviar<span style="color: #000066;">:</span> TButton<span style="color: #000066;">;</span>
    Label2<span style="color: #000066;">:</span> TLabel<span style="color: #000066;">;</span>
    mnuMain<span style="color: #000066;">:</span> TPopupMenu<span style="color: #000066;">;</span>
    mnuCortar<span style="color: #000066;">:</span> TMenuItem<span style="color: #000066;">;</span>
    mnuCopiar<span style="color: #000066;">:</span> TMenuItem<span style="color: #000066;">;</span>
    mnuPegar<span style="color: #000066;">:</span> TMenuItem<span style="color: #000066;">;</span>
    mnuEliminar<span style="color: #000066;">:</span> TMenuItem<span style="color: #000066;">;</span>
    N1<span style="color: #000066;">:</span> TMenuItem<span style="color: #000066;">;</span>
    mnuSeleccionar<span style="color: #000066;">:</span> TMenuItem<span style="color: #000066;">;</span>
    N2<span style="color: #000066;">:</span> TMenuItem<span style="color: #000066;">;</span>
    mnuDeshacer<span style="color: #000066;">:</span> TMenuItem<span style="color: #000066;">;</span>
    N3<span style="color: #000066;">:</span> TMenuItem<span style="color: #000066;">;</span>
    mnuWindows<span style="color: #000066;">:</span> TMenuItem<span style="color: #000066;">;</span>
    N4<span style="color: #000066;">:</span> TMenuItem<span style="color: #000066;">;</span>
    chkOnTop<span style="color: #000066;">:</span> TCheckBox<span style="color: #000066;">;</span>
    btnMenu<span style="color: #000066;">:</span> TButton<span style="color: #000066;">;</span>
    mnuEnviar<span style="color: #000066;">:</span> TMenuItem<span style="color: #000066;">;</span>
    mnuBucle<span style="color: #000066;">:</span> TMenuItem<span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">procedure</span> FormCreate<span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">procedure</span> EnviarClick<span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">procedure</span> mnuDeshacerClick<span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">procedure</span> mnuCortarClick<span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">procedure</span> mnuCopiarClick<span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">procedure</span> mnuPegarClick<span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">procedure</span> mnuEliminarClick<span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">procedure</span> mnuSeleccionarClick<span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">procedure</span> mnuWindowsClick<span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">procedure</span> chkOnTopClick<span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">procedure</span> btnMenuClick<span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">procedure</span> mnuBucleClick<span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">private</span>
    <span style="color: #808080; font-style: italic;">{ Private declarations }</span>
  <span style="color: #000000; font-weight: bold;">public</span>
    <span style="color: #808080; font-style: italic;">{ Public declarations }</span>
  <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">var</span>
  frmMain<span style="color: #000066;">:</span> TfrmMain<span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">implementation</span>
 
<span style="color: #008000; font-style: italic;">{$R *.dfm}</span>
 
<span style="color: #000000; font-weight: bold;">uses</span> Printers<span style="color: #000066;">,</span> WinSpool<span style="color: #000066;">,</span> Clipbrd<span style="color: #000066;">,</span> ufrmBucle<span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">function</span> RawToWindows<span style="color: #000066;">(</span>Str<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">String</span><span style="color: #000066;">)</span><span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">String</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">var</span>
  i<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Integer</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  Result<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #ff0000;">'&lt;'</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">while</span> <span style="color: #000066;">Length</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">)</span> &gt; <span style="color: #0000ff;">0</span> <span style="color: #000000; font-weight: bold;">do</span>
  <span style="color: #000000; font-weight: bold;">begin</span>
    <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #000066;">Copy</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">,</span> <span style="color: #0000ff;">1</span><span style="color: #000066;">,</span> <span style="color: #0000ff;">1</span><span style="color: #000066;">)</span> <span style="color: #000066;">=</span> <span style="color: #ff0000;">'\'</span> <span style="color: #000000; font-weight: bold;">then</span>
    <span style="color: #000000; font-weight: bold;">begin</span>
      <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #000066;">Uppercase</span><span style="color: #000066;">(</span><span style="color: #000066;">Copy</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">,</span> <span style="color: #0000ff;">2</span><span style="color: #000066;">,</span> <span style="color: #0000ff;">1</span><span style="color: #000066;">)</span><span style="color: #000066;">)</span> <span style="color: #000066;">=</span> <span style="color: #ff0000;">'X'</span> <span style="color: #000000; font-weight: bold;">then</span>
        Str<span style="color: #000066;">[</span><span style="color: #0000ff;">2</span><span style="color: #000066;">]</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #ff0000;">'$'</span><span style="color: #000066;">;</span>
      <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #000000; font-weight: bold;">not</span> <span style="color: #000066;">TryStrToInt</span><span style="color: #000066;">(</span><span style="color: #000066;">Copy</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">,</span> <span style="color: #0000ff;">2</span><span style="color: #000066;">,</span> <span style="color: #0000ff;">3</span><span style="color: #000066;">)</span><span style="color: #000066;">,</span>i<span style="color: #000066;">)</span> <span style="color: #000000; font-weight: bold;">then</span>
        Continue<span style="color: #000066;">;</span>
      <span style="color: #000066;">Delete</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">,</span> <span style="color: #0000ff;">1</span><span style="color: #000066;">,</span> <span style="color: #0000ff;">3</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">end</span> <span style="color: #000000; font-weight: bold;">else</span> i<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #000066; font-weight: bold;">Byte</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">[</span><span style="color: #0000ff;">1</span><span style="color: #000066;">]</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000066;">Delete</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">,</span><span style="color: #0000ff;">1</span><span style="color: #000066;">,</span><span style="color: #0000ff;">1</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    Result<span style="color: #000066;">:</span><span style="color: #000066;">=</span> Result <span style="color: #000066;">+</span> <span style="color: #000066;">IntToHex</span><span style="color: #000066;">(</span>i<span style="color: #000066;">,</span><span style="color: #0000ff;">2</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
  Result<span style="color: #000066;">:</span><span style="color: #000066;">=</span> Result <span style="color: #000066;">+</span> <span style="color: #ff0000;">'&gt;'</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>  
 
<span style="color: #000000; font-weight: bold;">function</span> WriteRawDataToPrinter<span style="color: #000066;">(</span>PrinterName<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">String</span><span style="color: #000066;">;</span> Str<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">String</span><span style="color: #000066;">)</span><span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Boolean</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">var</span>
  PrinterHandle<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">THandle</span><span style="color: #000066;">;</span>
  DocInfo<span style="color: #000066;">:</span> TDocInfo1<span style="color: #000066;">;</span>
  i<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Integer</span><span style="color: #000066;">;</span>
  B<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Byte</span><span style="color: #000066;">;</span>
  Escritos<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">DWORD</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  Result<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #000000; font-weight: bold;">FALSE</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">if</span> OpenPrinter<span style="color: #000066;">(</span><span style="color: #000066; font-weight: bold;">PChar</span><span style="color: #000066;">(</span>PrinterName<span style="color: #000066;">)</span><span style="color: #000066;">,</span> PrinterHandle<span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">nil</span><span style="color: #000066;">)</span> <span style="color: #000000; font-weight: bold;">then</span>
  <span style="color: #000000; font-weight: bold;">try</span>
    <span style="color: #000066;">FillChar</span><span style="color: #000066;">(</span>DocInfo<span style="color: #000066;">,</span><span style="color: #000066;">Sizeof</span><span style="color: #000066;">(</span>DocInfo<span style="color: #000066;">)</span><span style="color: #000066;">,</span><span style="color: #ff0000;">#0</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">with</span> DocInfo <span style="color: #000000; font-weight: bold;">do</span>
    <span style="color: #000000; font-weight: bold;">begin</span>
      pDocName<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #000066; font-weight: bold;">PChar</span><span style="color: #000066;">(</span><span style="color: #ff0000;">'Printer Test'</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
      pOutputFile<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #000000; font-weight: bold;">nil</span><span style="color: #000066;">;</span>
      pDataType<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #ff0000;">'RAW'</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">if</span> StartDocPrinter<span style="color: #000066;">(</span>PrinterHandle<span style="color: #000066;">,</span> <span style="color: #0000ff;">1</span><span style="color: #000066;">,</span> <span style="color: #000066;">@</span>DocInfo<span style="color: #000066;">)</span> &lt;&gt; <span style="color: #0000ff;">0</span> <span style="color: #000000; font-weight: bold;">then</span>
    <span style="color: #000000; font-weight: bold;">try</span>
      <span style="color: #000000; font-weight: bold;">if</span> StartPagePrinter<span style="color: #000066;">(</span>PrinterHandle<span style="color: #000066;">)</span> <span style="color: #000000; font-weight: bold;">then</span>
      <span style="color: #000000; font-weight: bold;">try</span>
        <span style="color: #000000; font-weight: bold;">while</span> <span style="color: #000066;">Length</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">)</span> &gt; <span style="color: #0000ff;">0</span> <span style="color: #000000; font-weight: bold;">do</span>
        <span style="color: #000000; font-weight: bold;">begin</span>
          <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #000066;">Copy</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">,</span> <span style="color: #0000ff;">1</span><span style="color: #000066;">,</span> <span style="color: #0000ff;">1</span><span style="color: #000066;">)</span> <span style="color: #000066;">=</span> <span style="color: #ff0000;">'\'</span> <span style="color: #000000; font-weight: bold;">then</span>
          <span style="color: #000000; font-weight: bold;">begin</span>
            <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #000066;">Uppercase</span><span style="color: #000066;">(</span><span style="color: #000066;">Copy</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">,</span> <span style="color: #0000ff;">2</span><span style="color: #000066;">,</span> <span style="color: #0000ff;">1</span><span style="color: #000066;">)</span><span style="color: #000066;">)</span> <span style="color: #000066;">=</span> <span style="color: #ff0000;">'X'</span> <span style="color: #000000; font-weight: bold;">then</span>
              Str<span style="color: #000066;">[</span><span style="color: #0000ff;">2</span><span style="color: #000066;">]</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #ff0000;">'$'</span><span style="color: #000066;">;</span>
            <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #000000; font-weight: bold;">not</span> <span style="color: #000066;">TryStrToInt</span><span style="color: #000066;">(</span><span style="color: #000066;">Copy</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">,</span> <span style="color: #0000ff;">2</span><span style="color: #000066;">,</span> <span style="color: #0000ff;">3</span><span style="color: #000066;">)</span><span style="color: #000066;">,</span>i<span style="color: #000066;">)</span> <span style="color: #000000; font-weight: bold;">then</span>
              Exit<span style="color: #000066;">;</span>
            B<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #000066; font-weight: bold;">Byte</span><span style="color: #000066;">(</span>i<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
            <span style="color: #000066;">Delete</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">,</span> <span style="color: #0000ff;">1</span><span style="color: #000066;">,</span> <span style="color: #0000ff;">3</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
          <span style="color: #000000; font-weight: bold;">end</span> <span style="color: #000000; font-weight: bold;">else</span> B<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #000066; font-weight: bold;">Byte</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">[</span><span style="color: #0000ff;">1</span><span style="color: #000066;">]</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
          <span style="color: #000066;">Delete</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">,</span><span style="color: #0000ff;">1</span><span style="color: #000066;">,</span><span style="color: #0000ff;">1</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
          WritePrinter<span style="color: #000066;">(</span>PrinterHandle<span style="color: #000066;">,</span> <span style="color: #000066;">@</span>B<span style="color: #000066;">,</span> <span style="color: #0000ff;">1</span><span style="color: #000066;">,</span> Escritos<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
        <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
        Result<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #000000; font-weight: bold;">TRUE</span><span style="color: #000066;">;</span>
      <span style="color: #000000; font-weight: bold;">finally</span>
        EndPagePrinter<span style="color: #000066;">(</span>PrinterHandle<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
      <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">finally</span>
      EndDocPrinter<span style="color: #000066;">(</span>PrinterHandle<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">finally</span>
    ClosePrinter<span style="color: #000066;">(</span>PrinterHandle<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> TfrmMain<span style="color: #000066;">.</span><span style="color: #006600;">btnMenuClick</span><span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">var</span>
  P<span style="color: #000066;">:</span> TPoint<span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  GetCursorPos<span style="color: #000066;">(</span>P<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  mnuMain<span style="color: #000066;">.</span><span style="color: #006600;">Popup</span><span style="color: #000066;">(</span>P<span style="color: #000066;">.</span><span style="color: #006600;">X</span><span style="color: #000066;">,</span> P<span style="color: #000066;">.</span><span style="color: #006600;">Y</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> TfrmMain<span style="color: #000066;">.</span><span style="color: #006600;">chkOnTopClick</span><span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  <span style="color: #000000; font-weight: bold;">if</span> chkOnTop<span style="color: #000066;">.</span><span style="color: #006600;">Checked</span> <span style="color: #000000; font-weight: bold;">then</span>
    FormStyle<span style="color: #000066;">:</span><span style="color: #000066;">=</span> fsStayOnTop
  <span style="color: #000000; font-weight: bold;">else</span>
    FormStyle<span style="color: #000066;">:</span><span style="color: #000066;">=</span> fsNormal<span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> TfrmMain<span style="color: #000066;">.</span><span style="color: #006600;">EnviarClick</span><span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  <span style="color: #000000; font-weight: bold;">if</span> cmbPrinters<span style="color: #000066;">.</span><span style="color: #006600;">ItemIndex</span> &gt;<span style="color: #000066;">=</span> <span style="color: #0000ff;">0</span> <span style="color: #000000; font-weight: bold;">then</span>
  <span style="color: #000000; font-weight: bold;">begin</span>
    WriteRawDataToPrinter<span style="color: #000066;">(</span>cmbPrinters<span style="color: #000066;">.</span><span style="color: #006600;">Items</span><span style="color: #000066;">[</span>cmbPrinters<span style="color: #000066;">.</span><span style="color: #006600;">ItemIndex</span><span style="color: #000066;">]</span><span style="color: #000066;">,</span>
      txtSecuencia<span style="color: #000066;">.</span><span style="color: #006600;">Text</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> TfrmMain<span style="color: #000066;">.</span><span style="color: #006600;">FormCreate</span><span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  cmbPrinters<span style="color: #000066;">.</span><span style="color: #006600;">Items</span><span style="color: #000066;">.</span><span style="color: #006600;">Assign</span><span style="color: #000066;">(</span>Printer<span style="color: #000066;">.</span><span style="color: #006600;">Printers</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> TfrmMain<span style="color: #000066;">.</span><span style="color: #006600;">mnuCopiarClick</span><span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  txtSecuencia<span style="color: #000066;">.</span><span style="color: #006600;">CopyToClipboard</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> TfrmMain<span style="color: #000066;">.</span><span style="color: #006600;">mnuCortarClick</span><span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  txtSecuencia<span style="color: #000066;">.</span><span style="color: #006600;">CutToClipboard</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> TfrmMain<span style="color: #000066;">.</span><span style="color: #006600;">mnuDeshacerClick</span><span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  txtSecuencia<span style="color: #000066;">.</span><span style="color: #006600;">Undo</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> TfrmMain<span style="color: #000066;">.</span><span style="color: #006600;">mnuEliminarClick</span><span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  txtSecuencia<span style="color: #000066;">.</span><span style="color: #006600;">ClearSelection</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> TfrmMain<span style="color: #000066;">.</span><span style="color: #006600;">mnuPegarClick</span><span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  txtSecuencia<span style="color: #000066;">.</span><span style="color: #006600;">PasteFromClipboard</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> TfrmMain<span style="color: #000066;">.</span><span style="color: #006600;">mnuBucleClick</span><span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  <span style="color: #000000; font-weight: bold;">with</span> TfrmBucle<span style="color: #000066;">.</span><span style="color: #006600;">Create</span><span style="color: #000066;">(</span><span style="color: #000000; font-weight: bold;">Self</span><span style="color: #000066;">)</span> <span style="color: #000000; font-weight: bold;">do</span>
  <span style="color: #000000; font-weight: bold;">try</span>
    ShowModal<span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">finally</span>
    Free<span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> TfrmMain<span style="color: #000066;">.</span><span style="color: #006600;">mnuSeleccionarClick</span><span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  txtSecuencia<span style="color: #000066;">.</span><span style="color: #006600;">SelectAll</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> TfrmMain<span style="color: #000066;">.</span><span style="color: #006600;">mnuWindowsClick</span><span style="color: #000066;">(</span>Sender<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">TObject</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  ClipBoard<span style="color: #000066;">.</span><span style="color: #006600;">AsText</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> RawToWindows<span style="color: #000066;">(</span>txtSecuencia<span style="color: #000066;">.</span><span style="color: #006600;">SelText</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">.</span></pre></div>
<p>El código lo puedes bajar de <a href="/sites/delphi.jmrds.com/adjuntos/printtest_delphi.zip"><b>aquí</b></a>, y el programa ya compilado de <a href="/sites/delphi.jmrds.com/adjuntos/printtest.zip"><b>aquí.</b></a></p>
<p><b>Actualización:</b> A raíz de una petición formulada en uno de los comentarios he decidido crear este pequeño ejecutable que permite usar la función WriteRawDataToPrinter directamente desde la linea de comandos, de esta manera se puede utilizar en archivos .bat, en accesos directos, etc ... El programa se puede descargar de <a href="/sites/delphi.jmrds.com/adjuntos/rawprint.zip"><b>aquí.</b></a></p>
<p>Un ejemplo de como usarlo:</p>
<div class="geshifilter">
<pre class="text geshifilter-text" style="font-family:monospace;">rawprint "nombre_de_la_impresora" "\x1B@\x0A\x0D\027\112\000\100\250\x0A\x0D"</pre></div>
</div></div></div>    <footer>
        <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul>  </footer>
    <div id="comments" class="comment-wrapper">
          <h2 class="title">Comentarios</h2>
      
  <a id="comment-86"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/86#comment-86" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/86#comment-86" class="permalink" rel="bookmark">Vaya, tanto tiempo sin</a></h3>
  
  <div class="submitted">
    <a href="/comment/86#comment-86" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2009-02-03T23:37:00+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Casimiro Notevi (no verificado)</span> el Mar, 02/03/2009 - 23:37</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Vaya, tanto tiempo sin escribir nada, se ve que has estado ocupado.<br />
Saluditos.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
<a id="comment-87"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/87#comment-87" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/87#comment-87" class="permalink" rel="bookmark">Que buen aporte... gracias</a></h3>
  
  <div class="submitted">
    <a href="/comment/87#comment-87" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2009-02-04T14:56:00+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Felipe (no verificado)</span> el Mié, 02/04/2009 - 14:56</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Que buen aporte... gracias :)</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
<a id="comment-88"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/88#comment-88" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/88#comment-88" class="permalink" rel="bookmark">Hey amigo.
Me da gusto que</a></h3>
  
  <div class="submitted">
    <a href="/comment/88#comment-88" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2009-02-05T23:27:00+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <a href="http://egostar.delphiaccess.com" rel="nofollow foaf:page" class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Eliseo GN (no verificado)</a> el Jue, 02/05/2009 - 23:27</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Hey amigo.</p>
<p>Me da gusto que hayas publicado algo mas en esta página :) </p>
<p>Muy intersante forma de imprimir, yo normalmente uso el canvas, así que probaré tu code.</p>
<p>Salud OS</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
<a id="comment-115"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/115#comment-115" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/115#comment-115" class="permalink" rel="bookmark">Muchas gracias, es un buen</a></h3>
  
  <div class="submitted">
    <a href="/comment/115#comment-115" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2009-05-08T18:55:00+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Joseme (no verificado)</span> el Vie, 05/08/2009 - 18:55</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Muchas gracias, es un buen aporte, yo trabajo mucho con impresoras TM-U de Epson.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
<a id="comment-269"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/269#comment-269" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/269#comment-269" class="permalink" rel="bookmark">Hola!
gran trabajo, nos ira</a></h3>
  
  <div class="submitted">
    <a href="/comment/269#comment-269" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2010-04-16T09:20:00+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Asensio (no verificado)</span> el Vie, 04/16/2010 - 09:20</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Hola!<br />
gran trabajo, nos ira perfecto para probar las impresoras TM de Epson.<br />
Solo tengo una duda:<br />
intento imprimir un logotipo gráfico previamente grabado en la memoria de la impresora y no lo consigo.<br />
Los codigos ESC que tengo para esto son:<br />
para la EPSON TM-T88, T88II y T88III : 28,112,1,0<br />
para la EPSON TM-T88IV : 29,40,76,6,0,48,69,x,x,1,1 donde x es el numero que sale en el programa de carga del logo.<br />
Saludos.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>

<div class="indented"><a id="comment-271"></a>
<div class="comment comment-by-node-author clearfix" about="/comment/271#comment-271" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/271#comment-271" class="permalink" rel="bookmark">Yo para Epson tengo la</a></h3>
  
  <div class="submitted">
    <a href="/comment/271#comment-271" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2010-04-16T15:15:00+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" about="/user/1" typeof="sioc:UserAccount" property="foaf:name" datatype="">admin</span> el Vie, 04/16/2010 - 15:15</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><span rel="sioc:reply_of" resource="/comment/269#comment-269" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Yo para Epson tengo la siguiente secuencia:</p>
<div class="geshifilter">
<pre class="text geshifilter-text" style="font-family:monospace;">\x1C\x70\x01\x30\x0A\x0D</pre></div>
<p>Como ves solo se diferencia de la tuya en que, en vez de terminar en 0 termina en 30h que se corresponde con el valor ASCII de "0". Ademas he añadido un "retorno de carro" al final, a lo mejor no es necesario pero tampoco hace daño.</p>
<p>En cuanto a la TM-T88IV creo que sirve la misma secuencia que para las demás TM-T88, pruebalo.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
</div><a id="comment-651"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/651#comment-651" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/651#comment-651" class="permalink" rel="bookmark">Gracias por compartir este</a></h3>
  
  <div class="submitted">
    <a href="/comment/651#comment-651" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2011-03-02T19:04:32+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Anonimo (no verificado)</span> el Mié, 03/02/2011 - 19:04</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Gracias por compartir este código.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
<a id="comment-688"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/688#comment-688" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/688#comment-688" class="permalink" rel="bookmark">Interesante codigo. Por</a></h3>
  
  <div class="submitted">
    <a href="/comment/688#comment-688" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2011-05-13T12:45:36+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Jonathan (no verificado)</span> el Vie, 05/13/2011 - 12:45</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Interesante codigo. Por cierto, tal vez puedas ayudarme. Tengo una impresora termica hasar conectada por USB a la maquina, con estas lineas que compartiste en este post puedo enviar correctamente comandos a la impresora, pero no se como leer o interpretar las respuestas. Por ejemplo, una consulta de estado al impresora. Podras ayudarme con eso?? muchas gracias desde ya.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>

<div class="indented"><a id="comment-689"></a>
<div class="comment comment-by-node-author clearfix" about="/comment/689#comment-689" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/689#comment-689" class="permalink" rel="bookmark">Pues la verdad es que nunca</a></h3>
  
  <div class="submitted">
    <a href="/comment/689#comment-689" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2011-05-13T14:06:00+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" about="/user/1" typeof="sioc:UserAccount" property="foaf:name" datatype="">admin</span> el Vie, 05/13/2011 - 14:06</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><span rel="sioc:reply_of" resource="/comment/688#comment-688" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Pues la verdad es que nunca he probado, pero me imagino que, al igual que podemos usar la función WritePrinter para enviar datos a la impresora, podemos recibir información de la impresora con la función ReadPrinter. Yo empezaría a buscar por ahí.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
</div><a id="comment-690"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/690#comment-690" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/690#comment-690" class="permalink" rel="bookmark">Gracias por tan inmediata</a></h3>
  
  <div class="submitted">
    <a href="/comment/690#comment-690" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2011-05-13T14:41:36+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Jonathan (no verificado)</span> el Vie, 05/13/2011 - 14:41</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Gracias por tan inmediata respuesta. Te comento que es la primera vez que tratamos con este tipo de impresoras. Intentamos usar la funcion ReadPrinter pero no obtuvimos resultados muy claros. Te pregunte porque tal vez alguna vez habias tratado con algo similar. Desde ya agradezco tu aporte y veremos como seguimos. Suerte.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
<a id="comment-775"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/775#comment-775" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/775#comment-775" class="permalink" rel="bookmark">Hola buen día, en caso de</a></h3>
  
  <div class="submitted">
    <a href="/comment/775#comment-775" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2011-09-07T17:56:06+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Alejandro (no verificado)</span> el Mié, 09/07/2011 - 17:56</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Hola buen día, en caso de querer enviar el documento a imprimir con cierta fuente y tamaño de letra, diferente tamaño y orientación de papel, que comandos se utilizan??</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>

<div class="indented"><a id="comment-776"></a>
<div class="comment comment-by-node-author clearfix" about="/comment/776#comment-776" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/776#comment-776" class="permalink" rel="bookmark">El código esta pensado solo</a></h3>
  
  <div class="submitted">
    <a href="/comment/776#comment-776" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2011-09-07T18:15:43+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" about="/user/1" typeof="sioc:UserAccount" property="foaf:name" datatype="">admin</span> el Mié, 09/07/2011 - 18:15</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><span rel="sioc:reply_of" resource="/comment/775#comment-775" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>El código esta pensado solo para impresoras de tickets. </p>
<p>Si necesitas imprimir en una impresora normal, con diferentes fuentes y orientaciones del papel, debes de utilizar el "Canvas" del objeto Printer.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>

<div class="indented"><a id="comment-777"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/777#comment-777" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/777#comment-777" class="permalink" rel="bookmark">Gracias por tu respuesta, no</a></h3>
  
  <div class="submitted">
    <a href="/comment/777#comment-777" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2011-09-07T18:29:50+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Alejandro (no verificado)</span> el Mié, 09/07/2011 - 18:29</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><span rel="sioc:reply_of" resource="/comment/776#comment-776" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Gracias por tu respuesta, no tendrás un código o ejemplo de Canvas??</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>

<div class="indented"><a id="comment-778"></a>
<div class="comment comment-by-node-author clearfix" about="/comment/778#comment-778" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/778#comment-778" class="permalink" rel="bookmark">Pues tengo este ejemplo que</a></h3>
  
  <div class="submitted">
    <a href="/comment/778#comment-778" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2011-09-07T21:00:12+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" about="/user/1" typeof="sioc:UserAccount" property="foaf:name" datatype="">admin</span> el Mié, 09/07/2011 - 21:00</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><span rel="sioc:reply_of" resource="/comment/777#comment-777" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Pues tengo este ejemplo que puse hace tiempo en un foro:</p>
<div class="geshifilter">
<pre class="delphi geshifilter-delphi" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">type</span>
  TPrinterCaps <span style="color: #000066;">=</span> <span style="color: #000000; font-weight: bold;">record</span>
    ppx<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">integer</span><span style="color: #000066;">;</span>
    ppy<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">integer</span><span style="color: #000066;">;</span>
    pox<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">integer</span><span style="color: #000066;">;</span>
    poy<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">integer</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
  TPrinterContext <span style="color: #000066;">=</span> <span style="color: #000000; font-weight: bold;">record</span>
    Caps<span style="color: #000066;">:</span> TPrinterCaps<span style="color: #000066;">;</span>
    Cursor<span style="color: #000066;">:</span> TPoint<span style="color: #000066;">;</span>
    Inter<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Double</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">function</span> CreatePrinterContext<span style="color: #000066;">:</span> TPrinterContext<span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  <span style="color: #000066;">FillChar</span><span style="color: #000066;">(</span>Result<span style="color: #000066;">,</span><span style="color: #000066;">Sizeof</span><span style="color: #000066;">(</span>Result<span style="color: #000066;">)</span><span style="color: #000066;">,</span><span style="color: #0000ff;">0</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">with</span> Result<span style="color: #000066;">.</span><span style="color: #006600;">Caps</span> <span style="color: #000000; font-weight: bold;">do</span>
  <span style="color: #000000; font-weight: bold;">begin</span>
    ppx<span style="color: #000066;">:</span><span style="color: #000066;">=</span> GetDeviceCaps<span style="color: #000066;">(</span>Printer<span style="color: #000066;">.</span><span style="color: #006600;">Handle</span><span style="color: #000066;">,</span> LOGPIXELSX<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    ppy<span style="color: #000066;">:</span><span style="color: #000066;">=</span> GetDeviceCaps<span style="color: #000066;">(</span>Printer<span style="color: #000066;">.</span><span style="color: #006600;">Handle</span><span style="color: #000066;">,</span> LOGPIXELSY<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    pox<span style="color: #000066;">:</span><span style="color: #000066;">=</span> GetDeviceCaps<span style="color: #000066;">(</span>Printer<span style="color: #000066;">.</span><span style="color: #006600;">Handle</span><span style="color: #000066;">,</span> PHYSICALOFFSETX<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    poy<span style="color: #000066;">:</span><span style="color: #000066;">=</span> GetDeviceCaps<span style="color: #000066;">(</span>Printer<span style="color: #000066;">.</span><span style="color: #006600;">Handle</span><span style="color: #000066;">,</span> PHYSICALOFFSETY<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
  Result<span style="color: #000066;">.</span><span style="color: #006600;">Inter</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #0000ff;">1.5</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">function</span> ToPixelsX<span style="color: #000066;">(</span>X<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Double</span><span style="color: #000066;">;</span> Context<span style="color: #000066;">:</span> TPrinterContext<span style="color: #000066;">)</span><span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Integer</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  <span style="color: #000000; font-weight: bold;">with</span> Context<span style="color: #000066;">.</span><span style="color: #006600;">Caps</span> <span style="color: #000000; font-weight: bold;">do</span>
    Result<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #000066;">Round</span><span style="color: #000066;">(</span><span style="color: #000066;">(</span>X <span style="color: #000066;">/</span> <span style="color: #0000ff;">25.4</span><span style="color: #000066;">)</span> <span style="color: #000066;">*</span> ppx<span style="color: #000066;">)</span> <span style="color: #000066;">-</span> pox<span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">function</span> ToPixelsY<span style="color: #000066;">(</span>Y<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Double</span><span style="color: #000066;">;</span> Context<span style="color: #000066;">:</span> TPrinterContext<span style="color: #000066;">)</span><span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Integer</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  <span style="color: #000000; font-weight: bold;">with</span> Context<span style="color: #000066;">.</span><span style="color: #006600;">Caps</span> <span style="color: #000000; font-weight: bold;">do</span>
    Result<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #000066;">Round</span><span style="color: #000066;">(</span><span style="color: #000066;">(</span>Y <span style="color: #000066;">/</span> <span style="color: #0000ff;">25.4</span><span style="color: #000066;">)</span> <span style="color: #000066;">*</span> ppy<span style="color: #000066;">)</span> <span style="color: #000066;">-</span> poy<span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> SetPrinterCursor<span style="color: #000066;">(</span>X<span style="color: #000066;">,</span> Y<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Double</span><span style="color: #000066;">;</span> <span style="color: #000000; font-weight: bold;">var</span> Context<span style="color: #000066;">:</span> TPrinterContext<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  <span style="color: #000000; font-weight: bold;">with</span> Context <span style="color: #000000; font-weight: bold;">do</span>
  <span style="color: #000000; font-weight: bold;">begin</span>
    <span style="color: #000000; font-weight: bold;">if</span> X &gt; <span style="color: #0000ff;">0</span> <span style="color: #000000; font-weight: bold;">then</span> Cursor<span style="color: #000066;">.</span><span style="color: #006600;">X</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> ToPixelsX<span style="color: #000066;">(</span>X<span style="color: #000066;">,</span>Context<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">if</span> Y &gt; <span style="color: #0000ff;">0</span> <span style="color: #000000; font-weight: bold;">then</span> Cursor<span style="color: #000066;">.</span><span style="color: #006600;">Y</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> ToPixelsY<span style="color: #000066;">(</span>Y<span style="color: #000066;">,</span>Context<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> IncPrinterCursor<span style="color: #000066;">(</span><span style="color: #000000; font-weight: bold;">var</span> Context<span style="color: #000066;">:</span> TPrinterContext<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  <span style="color: #000000; font-weight: bold;">with</span> Context<span style="color: #000066;">,</span> Context<span style="color: #000066;">.</span><span style="color: #006600;">Caps</span> <span style="color: #000000; font-weight: bold;">do</span>
  <span style="color: #000000; font-weight: bold;">begin</span>
    Cursor<span style="color: #000066;">.</span><span style="color: #006600;">Y</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> Cursor<span style="color: #000066;">.</span><span style="color: #006600;">Y</span> <span style="color: #000066;">+</span> <span style="color: #000066;">Round</span><span style="color: #000066;">(</span>Inter<span style="color: #000066;">*</span><span style="color: #000066;">(</span>Printer<span style="color: #000066;">.</span><span style="color: #006600;">Canvas</span><span style="color: #000066;">.</span><span style="color: #006600;">Font</span><span style="color: #000066;">.</span><span style="color: #006600;">Size</span> <span style="color: #000066;">*</span> ppy<span style="color: #000066;">)</span> <span style="color: #000066;">/</span> <span style="color: #0000ff;">72</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> DecPrinterCursor<span style="color: #000066;">(</span><span style="color: #000000; font-weight: bold;">var</span> Context<span style="color: #000066;">:</span> TPrinterContext<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  <span style="color: #000000; font-weight: bold;">with</span> Context<span style="color: #000066;">,</span> Context<span style="color: #000066;">.</span><span style="color: #006600;">Caps</span> <span style="color: #000000; font-weight: bold;">do</span>
  <span style="color: #000000; font-weight: bold;">begin</span>
    Cursor<span style="color: #000066;">.</span><span style="color: #006600;">Y</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> Cursor<span style="color: #000066;">.</span><span style="color: #006600;">Y</span> <span style="color: #000066;">-</span> <span style="color: #000066;">Round</span><span style="color: #000066;">(</span>Inter<span style="color: #000066;">*</span><span style="color: #000066;">(</span>Printer<span style="color: #000066;">.</span><span style="color: #006600;">Canvas</span><span style="color: #000066;">.</span><span style="color: #006600;">Font</span><span style="color: #000066;">.</span><span style="color: #006600;">Size</span> <span style="color: #000066;">*</span> ppy<span style="color: #000066;">)</span> <span style="color: #000066;">/</span> <span style="color: #0000ff;">72</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> PrinterWrite<span style="color: #000066;">(</span>Width<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Double</span><span style="color: #000066;">;</span> alRight<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Boolean</span><span style="color: #000066;">;</span> Str<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">string</span><span style="color: #000066;">;</span>
  Context<span style="color: #000066;">:</span> TPrinterContext<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">var</span>
  Rectangle<span style="color: #000066;">:</span> TRect<span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  <span style="color: #000000; font-weight: bold;">with</span> Context<span style="color: #000066;">,</span> Context<span style="color: #000066;">.</span><span style="color: #006600;">Caps</span> <span style="color: #000000; font-weight: bold;">do</span>
  <span style="color: #000000; font-weight: bold;">begin</span>
    Rectangle<span style="color: #000066;">.</span><span style="color: #006600;">Left</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> Cursor<span style="color: #000066;">.</span><span style="color: #006600;">X</span><span style="color: #000066;">;</span>
    Rectangle<span style="color: #000066;">.</span><span style="color: #006600;">Top</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> Cursor<span style="color: #000066;">.</span><span style="color: #006600;">Y</span><span style="color: #000066;">;</span>
    Rectangle<span style="color: #000066;">.</span><span style="color: #006600;">Right</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> Cursor<span style="color: #000066;">.</span><span style="color: #006600;">X</span> <span style="color: #000066;">+</span> <span style="color: #000066;">Round</span><span style="color: #000066;">(</span><span style="color: #000066;">(</span>Width <span style="color: #000066;">/</span> <span style="color: #0000ff;">25.4</span><span style="color: #000066;">)</span> <span style="color: #000066;">*</span> ppx<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">if</span> alRight <span style="color: #000000; font-weight: bold;">then</span> Cursor<span style="color: #000066;">.</span><span style="color: #006600;">X</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> Rectangle<span style="color: #000066;">.</span><span style="color: #006600;">Right</span> <span style="color: #000066;">-</span> Printer<span style="color: #000066;">.</span><span style="color: #006600;">Canvas</span><span style="color: #000066;">.</span><span style="color: #006600;">TextWidth</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    Rectangle<span style="color: #000066;">.</span><span style="color: #006600;">Bottom</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span>
      Cursor<span style="color: #000066;">.</span><span style="color: #006600;">Y</span> <span style="color: #000066;">+</span> <span style="color: #000066;">Round</span><span style="color: #000066;">(</span>Inter<span style="color: #000066;">*</span><span style="color: #000066;">(</span>Printer<span style="color: #000066;">.</span><span style="color: #006600;">Canvas</span><span style="color: #000066;">.</span><span style="color: #006600;">Font</span><span style="color: #000066;">.</span><span style="color: #006600;">Size</span> <span style="color: #000066;">*</span> ppy<span style="color: #000066;">)</span> <span style="color: #000066;">/</span> <span style="color: #0000ff;">72</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    Printer<span style="color: #000066;">.</span><span style="color: #006600;">Canvas</span><span style="color: #000066;">.</span><span style="color: #006600;">TextRect</span><span style="color: #000066;">(</span>Rectangle<span style="color: #000066;">,</span>Cursor<span style="color: #000066;">.</span><span style="color: #006600;">X</span><span style="color: #000066;">,</span>Cursor<span style="color: #000066;">.</span><span style="color: #006600;">Y</span><span style="color: #000066;">,</span>Str<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> PrinterTextOut<span style="color: #000066;">(</span>X<span style="color: #000066;">,</span> Y<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Double</span><span style="color: #000066;">;</span> Str<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">string</span><span style="color: #000066;">;</span> Context<span style="color: #000066;">:</span> TPrinterContext<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  Printer<span style="color: #000066;">.</span><span style="color: #006600;">Canvas</span><span style="color: #000066;">.</span><span style="color: #006600;">Textout</span><span style="color: #000066;">(</span>ToPixelsX<span style="color: #000066;">(</span>X<span style="color: #000066;">,</span>Context<span style="color: #000066;">)</span><span style="color: #000066;">,</span>ToPixelsY<span style="color: #000066;">(</span>Y<span style="color: #000066;">,</span>Context<span style="color: #000066;">)</span><span style="color: #000066;">,</span>Str<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> PrinterCenterText<span style="color: #000066;">(</span>X<span style="color: #000066;">,</span> Y<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Double</span><span style="color: #000066;">;</span> Str<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">string</span><span style="color: #000066;">;</span>
  Context<span style="color: #000066;">:</span> TPrinterContext<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  Printer<span style="color: #000066;">.</span><span style="color: #006600;">Canvas</span><span style="color: #000066;">.</span><span style="color: #006600;">Textout</span><span style="color: #000066;">(</span>
    ToPixelsX<span style="color: #000066;">(</span>X<span style="color: #000066;">,</span>Context<span style="color: #000066;">)</span> <span style="color: #000066;">-</span> <span style="color: #000066;">(</span>Printer<span style="color: #000066;">.</span><span style="color: #006600;">Canvas</span><span style="color: #000066;">.</span><span style="color: #006600;">TextWidth</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">)</span> <span style="color: #000000; font-weight: bold;">div</span> <span style="color: #0000ff;">2</span><span style="color: #000066;">)</span><span style="color: #000066;">,</span>
    ToPixelsY<span style="color: #000066;">(</span>Y<span style="color: #000066;">,</span>Context<span style="color: #000066;">)</span> <span style="color: #000066;">-</span> <span style="color: #000066;">(</span>Printer<span style="color: #000066;">.</span><span style="color: #006600;">Canvas</span><span style="color: #000066;">.</span><span style="color: #006600;">TextHeight</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">)</span> <span style="color: #000000; font-weight: bold;">div</span> <span style="color: #0000ff;">2</span><span style="color: #000066;">)</span><span style="color: #000066;">,</span>
    Str<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> PrinterMoveTo<span style="color: #000066;">(</span>X<span style="color: #000066;">,</span> Y<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Double</span><span style="color: #000066;">;</span> Context<span style="color: #000066;">:</span> TPrinterContext<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  Printer<span style="color: #000066;">.</span><span style="color: #006600;">Canvas</span><span style="color: #000066;">.</span><span style="color: #006600;">MoveTo</span><span style="color: #000066;">(</span>ToPixelsX<span style="color: #000066;">(</span>X<span style="color: #000066;">,</span>Context<span style="color: #000066;">)</span><span style="color: #000066;">,</span>ToPixelsY<span style="color: #000066;">(</span>Y<span style="color: #000066;">,</span>Context<span style="color: #000066;">)</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> PrinterLineTo<span style="color: #000066;">(</span>X<span style="color: #000066;">,</span> Y<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Double</span><span style="color: #000066;">;</span> Context<span style="color: #000066;">:</span> TPrinterContext<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  Printer<span style="color: #000066;">.</span><span style="color: #006600;">Canvas</span><span style="color: #000066;">.</span><span style="color: #006600;">LineTo</span><span style="color: #000066;">(</span>ToPixelsX<span style="color: #000066;">(</span>X<span style="color: #000066;">,</span>Context<span style="color: #000066;">)</span><span style="color: #000066;">,</span>ToPixelsY<span style="color: #000066;">(</span>Y<span style="color: #000066;">,</span>Context<span style="color: #000066;">)</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">procedure</span> PrinterLine<span style="color: #000066;">(</span>X1<span style="color: #000066;">,</span>Y1<span style="color: #000066;">,</span>X2<span style="color: #000066;">,</span>Y2<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Double</span><span style="color: #000066;">;</span> Context<span style="color: #000066;">:</span> TPrinterContext<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  PrinterMoveTo<span style="color: #000066;">(</span>X1<span style="color: #000066;">,</span>Y1<span style="color: #000066;">,</span>Context<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  PrinterLineTo<span style="color: #000066;">(</span>X2<span style="color: #000066;">,</span>Y2<span style="color: #000066;">,</span>Context<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
 
<span style="color: #808080; font-style: italic;">// Y uso las funciones anteriores de esta manera</span>
<span style="color: #000000; font-weight: bold;">var</span>
  i<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Integer</span><span style="color: #000066;">;</span>
  Context<span style="color: #000066;">:</span> TPrinterContext<span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  <span style="color: #000000; font-weight: bold;">with</span> TPrinterSetupDialog<span style="color: #000066;">.</span><span style="color: #006600;">Create</span><span style="color: #000066;">(</span><span style="color: #000000; font-weight: bold;">nil</span><span style="color: #000066;">)</span> <span style="color: #000000; font-weight: bold;">do</span>
  <span style="color: #000000; font-weight: bold;">try</span>
    <span style="color: #000000; font-weight: bold;">if</span> Execute <span style="color: #000000; font-weight: bold;">then</span>
    <span style="color: #000000; font-weight: bold;">with</span> Printer <span style="color: #000000; font-weight: bold;">do</span>
    <span style="color: #000000; font-weight: bold;">begin</span>
      Printer<span style="color: #000066;">.</span><span style="color: #006600;">Orientation</span> <span style="color: #000066;">:</span><span style="color: #000066;">=</span> poPortrait<span style="color: #000066;">;</span>
      Printer<span style="color: #000066;">.</span><span style="color: #006600;">BeginDoc</span><span style="color: #000066;">;</span>
      <span style="color: #000000; font-weight: bold;">try</span>
        Context<span style="color: #000066;">:</span><span style="color: #000066;">=</span> CreatePrinterContext<span style="color: #000066;">;</span>
        Canvas<span style="color: #000066;">.</span><span style="color: #006600;">Font</span><span style="color: #000066;">.</span><span style="color: #006600;">Name</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #ff0000;">'Arial'</span><span style="color: #000066;">;</span>
        Canvas<span style="color: #000066;">.</span><span style="color: #006600;">Font</span><span style="color: #000066;">.</span><span style="color: #006600;">Color</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> clBlack<span style="color: #000066;">;</span>
        Canvas<span style="color: #000066;">.</span><span style="color: #006600;">Font</span><span style="color: #000066;">.</span><span style="color: #006600;">Size</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #0000ff;">10</span><span style="color: #000066;">;</span>
        SetPrinterCursor<span style="color: #000066;">(</span><span style="color: #0000ff;">20</span><span style="color: #000066;">,</span><span style="color: #0000ff;">20</span><span style="color: #000066;">,</span>Context<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
        <span style="color: #000000; font-weight: bold;">for</span> i<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #0000ff;">1</span> <span style="color: #000000; font-weight: bold;">to</span> <span style="color: #0000ff;">20</span> <span style="color: #000000; font-weight: bold;">do</span>
        <span style="color: #000000; font-weight: bold;">begin</span>
          PrinterWrite<span style="color: #000066;">(</span><span style="color: #0000ff;">100</span><span style="color: #000066;">,</span><span style="color: #000000; font-weight: bold;">FALSE</span><span style="color: #000066;">,</span><span style="color: #ff0000;">'Linea '</span> <span style="color: #000066;">+</span> <span style="color: #000066;">IntToStr</span><span style="color: #000066;">(</span>i<span style="color: #000066;">)</span><span style="color: #000066;">,</span>Context<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
          incPrinterCursor<span style="color: #000066;">(</span>Context<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
        <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
        Printer<span style="color: #000066;">.</span><span style="color: #006600;">EndDoc</span><span style="color: #000066;">;</span>
      <span style="color: #000000; font-weight: bold;">except</span>
        Printer<span style="color: #000066;">.</span><span style="color: #006600;">Abort</span><span style="color: #000066;">;</span>
      <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">finally</span>
    Free<span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span></pre></div>
<p>Las medidas (X,Y) son en milímetros medidas desde la esquina superior izquierda de la hoja de papel.</p>
<p>Recuerda añadir Printers a las uses</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
</div></div></div><a id="comment-811"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/811#comment-811" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/811#comment-811" class="permalink" rel="bookmark">Muchas gracias.</a></h3>
  
  <div class="submitted">
    <a href="/comment/811#comment-811" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2011-11-13T19:40:56+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Shirley (no verificado)</span> el Dom, 11/13/2011 - 19:40</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Muchas gracias.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
<a id="comment-814"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/814#comment-814" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/814#comment-814" class="permalink" rel="bookmark">Muy buenas,</a></h3>
  
  <div class="submitted">
    <a href="/comment/814#comment-814" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2011-11-25T10:51:15+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Txelis (no verificado)</span> el Vie, 11/25/2011 - 10:51</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Muy buenas,</p>
<p>Vaya por delante que no tengo ni idea de programación.</p>
<p>El hecho es que usando el PrintTest para abrir el cajon monedero (con una Epson TM-T20 y Win7 SP1, conectada por USB) me abre el cajon pero me hace un molestisimo feed (un avance de papel). Finalmente lo he resuelto metiendo el siguiente codigo con el susodicho programa: "\027\112\000\100\250" (sin comillas) y perfecto, me abre el cajon y NO hay feed.</p>
<p>Como podria traspasar este codigo a un fichero bat. Ya que el programa que uso tira de un bat para abrir el cajon pulsando un boton (imprimiendo si me abre, pero quiero poder usar el boton existente).</p>
<p>De momento con el programa solo he podito conseguir abrir el cajon y que me haga un feed tambien. Esto lo he conseguido instlando unos drivers para de manera virtual decirle que el puerto usb de la impresora esta en el LPT1. Y el programa me dice que en el bat le lance el siguiente codigo: "echo ←p0 5 &gt; lpt2" (sin comillas) y lo dicho, el boton funciona pero me hace un puñetero feed.</p>
<p>Que puedo hacer para evitar este feed??. Porque con el PrintTest no me hace el feed y encima no necesito virtualizar nada??.</p>
<p>Si podeis ayudarme alguien por favor, os lo agradeceria, llevo dias buscando por internet y no consigo arreglarlo.</p>
<p>Un saludo,</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>

<div class="indented"><a id="comment-815"></a>
<div class="comment comment-by-node-author clearfix" about="/comment/815#comment-815" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/815#comment-815" class="permalink" rel="bookmark">El comando &quot;echo&quot; siempre</a></h3>
  
  <div class="submitted">
    <a href="/comment/815#comment-815" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2011-11-25T15:23:42+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" about="/user/1" typeof="sioc:UserAccount" property="foaf:name" datatype="">admin</span> el Vie, 11/25/2011 - 15:23</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><span rel="sioc:reply_of" resource="/comment/814#comment-814" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>El comando "echo" siempre envía un avance de linea al final, por eso seguramente te esta imprimiendo una linea vacía. </p>
<p>No lo he probado, pero se me ocurre que puedes utilizar el comando "type" en vez de "echo". Lo que tendrías que hacer es crear un archivo de texto y meter solo esa linea, asegurándote de que no hay ninguna linea en blanco. Luego solo tendrías que sustituir el comando que usas por esto otro: </p>
<p><span class="geshifilter"><code class="text geshifilter-text">type archivo.txt&gt;lpt2</code></span></p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
</div><a id="comment-816"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/816#comment-816" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/816#comment-816" class="permalink" rel="bookmark">Efectivamente. si señor!!.</a></h3>
  
  <div class="submitted">
    <a href="/comment/816#comment-816" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2011-11-25T18:35:10+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Txelis (no verificado)</span> el Vie, 11/25/2011 - 18:35</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Efectivamente. si señor!!. Ademas justo a medio dia he encontrado por internet alguien que habia dejado un bat y un txt preparados asi, lo he probado y funciona:</p>
<p>En el bat: type open.txt &gt; lpt2<br />
Y en el txt: ←p</p>
<p>Nota: La flecha tiene que ser copy-paste del txt que he bajado, si hago Alt+27 me sale una flecha algo distinta que no me deja guardar (no se si porque es formato unicode y guardo en ansi, en fin, no me lio mas).</p>
<p>Lo cierto es que sois unos cracks, tu y el que haya dejado los ficheros preparados. Porque vamos, los del programa no tienen ni idea, los de Epson tampoco, y las soluciones que habia por la red no funcionaba ninguna, y he probado varias.</p>
<p>Muuuchisimas gracias.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
<a id="comment-860"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/860#comment-860" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/860#comment-860" class="permalink" rel="bookmark">Hola,</a></h3>
  
  <div class="submitted">
    <a href="/comment/860#comment-860" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2012-02-08T18:21:56+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Juanjo (no verificado)</span> el Mié, 02/08/2012 - 18:21</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Hola,<br />
He probado el printtest con la cadena de apertura de cajon y funciona perfecto. No soy programador por lo que necesitaria vuestra ayuda. Podrias pasarme un archivo en el que le mande la cadena de apertura a una impresora con el nombre TICKETS, para ejecutar el .exe y sin necesidad de seleccionar impresora abrir el cajon.<br />
Muchas gracias.<br />
Un saludo.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>

<div class="indented"><a id="comment-861"></a>
<div class="comment comment-by-node-author clearfix" about="/comment/861#comment-861" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/861#comment-861" class="permalink" rel="bookmark">Si puedes esperar unos dias</a></h3>
  
  <div class="submitted">
    <a href="/comment/861#comment-861" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2012-02-08T20:22:45+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" about="/user/1" typeof="sioc:UserAccount" property="foaf:name" datatype="">admin</span> el Mié, 02/08/2012 - 20:22</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><span rel="sioc:reply_of" resource="/comment/860#comment-860" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Si puedes esperar unos dias creo que podre subir el programa que necesitas</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
</div><a id="comment-862"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/862#comment-862" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/862#comment-862" class="permalink" rel="bookmark">Claro, puedo esperar, muchas</a></h3>
  
  <div class="submitted">
    <a href="/comment/862#comment-862" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2012-02-09T08:43:07+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Juanjo (no verificado)</span> el Jue, 02/09/2012 - 08:43</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Claro, puedo esperar, muchas gracias.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>

<div class="indented"><a id="comment-863"></a>
<div class="comment comment-by-node-author clearfix" about="/comment/863#comment-863" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/863#comment-863" class="permalink" rel="bookmark">Pues te dejo el programa</a></h3>
  
  <div class="submitted">
    <a href="/comment/863#comment-863" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2012-02-09T10:32:58+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" about="/user/1" typeof="sioc:UserAccount" property="foaf:name" datatype="">admin</span> el Jue, 02/09/2012 - 10:32</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><span rel="sioc:reply_of" resource="/comment/862#comment-862" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Pues te dejo el programa arriba, al final del articulo, para que lo descargues. </p>
<p>Pruebalo, y ya me contaras si te fue útil.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
</div><a id="comment-864"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/864#comment-864" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/864#comment-864" class="permalink" rel="bookmark">Muchas gracias, funciona</a></h3>
  
  <div class="submitted">
    <a href="/comment/864#comment-864" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2012-02-09T12:35:44+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Juanjo (no verificado)</span> el Jue, 02/09/2012 - 12:35</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Muchas gracias, funciona perfecto. Tenia problemas con la apertura de cajon con las impresoras en Windows 7, y con esto me funciona perfectamente.</p>
<p>Un saludo.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
<a id="comment-872"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/872#comment-872" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/872#comment-872" class="permalink" rel="bookmark">Amigo su programa printtest</a></h3>
  
  <div class="submitted">
    <a href="/comment/872#comment-872" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2012-02-29T16:13:00+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">camilo (no verificado)</span> el Mié, 02/29/2012 - 16:13</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Amigo su programa printtest me abre el cajon perfectamente, hay alguna manera que yo pueda inluir el comando en un archivo y ejecutarlo mediante DOS, estoy con una impresora EPSON TM-U210A GRACIAS.!!</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>

<div class="indented"><a id="comment-873"></a>
<div class="comment comment-by-node-author clearfix" about="/comment/873#comment-873" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/873#comment-873" class="permalink" rel="bookmark">Si, precisamente al final del</a></h3>
  
  <div class="submitted">
    <a href="/comment/873#comment-873" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2012-02-29T20:59:00+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" about="/user/1" typeof="sioc:UserAccount" property="foaf:name" datatype="">admin</span> el Mié, 02/29/2012 - 20:59</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><span rel="sioc:reply_of" resource="/comment/872#comment-872" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Si, precisamente al final del articulo veras que he publicado una actualización, que no es mas que un programa de consola que permite pasar los parámetros desde la linea de comandos.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
</div><a id="comment-888"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/888#comment-888" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/888#comment-888" class="permalink" rel="bookmark">Muchas gracias, fue de mucha</a></h3>
  
  <div class="submitted">
    <a href="/comment/888#comment-888" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2012-03-27T21:37:00+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Julian (no verificado)</span> el Mar, 03/27/2012 - 21:37</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Muchas gracias, fue de mucha utilidad, si funciona... Felicitaciones.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
<a id="comment-909"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/909#comment-909" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/909#comment-909" class="permalink" rel="bookmark">Muchas Gracias, fue de gran</a></h3>
  
  <div class="submitted">
    <a href="/comment/909#comment-909" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2012-04-18T20:26:20+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Arturo (no verificado)</span> el Mié, 04/18/2012 - 20:26</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Muchas Gracias, fue de gran utilidad, pero tengo un detalle al imprimir las palabras con Acentos, &quot;ñ&quot; y las diericis. Alguien me pude ayudar al respecto?</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>

<div class="indented"><a id="comment-910"></a>
<div class="comment comment-by-node-author clearfix" about="/comment/910#comment-910" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/910#comment-910" class="permalink" rel="bookmark">El problema es que no estas</a></h3>
  
  <div class="submitted">
    <a href="/comment/910#comment-910" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2012-04-18T20:45:58+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" about="/user/1" typeof="sioc:UserAccount" property="foaf:name" datatype="">admin</span> el Mié, 04/18/2012 - 20:45</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><span rel="sioc:reply_of" resource="/comment/909#comment-909" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>El problema es que no estas usando el mismo juego de caracteres que la impresora, revisa su configuracion para saber que juego de carscteres esta usando.<br />
Otra solucion es mandar imprimir todos los caracteres, desde el \032 al \255, hasta averiguar que codigo se corresponde con cada caracter</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
</div><a id="comment-978"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/978#comment-978" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/978#comment-978" class="permalink" rel="bookmark">Hola</a></h3>
  
  <div class="submitted">
    <a href="/comment/978#comment-978" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2013-02-06T02:55:18+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Ivan Davila (no verificado)</span> el Mié, 02/06/2013 - 02:55</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Hola<br />
Tengo una impresora Zebra Gk420t como puedo imprimir una etiqueta con codigo de barra y darle el tamano q necesito con esta funcion</p>
<p>Muchas gracias</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>

<div class="indented"><a id="comment-979"></a>
<div class="comment comment-by-node-author clearfix" about="/comment/979#comment-979" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/979#comment-979" class="permalink" rel="bookmark">Nunca he trabajado con</a></h3>
  
  <div class="submitted">
    <a href="/comment/979#comment-979" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2013-02-06T08:10:00+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" about="/user/1" typeof="sioc:UserAccount" property="foaf:name" datatype="">admin</span> el Mié, 02/06/2013 - 08:10</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><span rel="sioc:reply_of" resource="/comment/978#comment-978" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Nunca he trabajado con impresoras Zebra así que no puedo ayudarte, pero supongo que si revisas el manual encontraras los comandos necesarios.</p>
<p>También puedes probar a preguntar en este foro, se que algún compañero ha utilizado impresoras Zebra antes y quizá pueda ayudarte:<br /><a href="http://www.delphiaccess.com/forum/forum/">http://www.delphiaccess.com/forum/forum/</a></p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
</div><a id="comment-985"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/985#comment-985" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/985#comment-985" class="permalink" rel="bookmark">Hola, ante todo muchas</a></h3>
  
  <div class="submitted">
    <a href="/comment/985#comment-985" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2013-03-19T05:07:08+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Rodrigo López (no verificado)</span> el Mar, 03/19/2013 - 05:07</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Hola, ante todo muchas gracias por compartir tus conocimientos, realmente me han servido de mucho.<br />
Estoy tratando de usar el programa rawprint para una aplicación con la impresora  Zebra GK420t, hasta ahora las  pruebas van bien, solo me falta una cosa, enviarle el contenido de un archivo como parámetro, es posible ? Podrías subir el código fuente del rawprint?<br />
Desde muchísimas gracias.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>

<div class="indented"><a id="comment-987"></a>
<div class="comment comment-by-node-author clearfix" about="/comment/987#comment-987" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/987#comment-987" class="permalink" rel="bookmark">El códgio de &quot;rawprint&quot; es</a></h3>
  
  <div class="submitted">
    <a href="/comment/987#comment-987" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2013-03-19T08:17:00+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" about="/user/1" typeof="sioc:UserAccount" property="foaf:name" datatype="">admin</span> el Mar, 03/19/2013 - 08:17</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><span rel="sioc:reply_of" resource="/comment/985#comment-985" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>El códgio de "rawprint" es muy sencillo:</p>
<div class="geshifilter">
<pre class="delphi geshifilter-delphi" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">program</span> rawprint<span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">uses</span>
  Windows<span style="color: #000066;">,</span>
  SysUtils<span style="color: #000066;">,</span>
  WinSpool<span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">function</span> WriteRawDataToPrinter<span style="color: #000066;">(</span>PrinterName<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">String</span><span style="color: #000066;">;</span> Str<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">String</span><span style="color: #000066;">)</span><span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Boolean</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">var</span>
  PrinterHandle<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">THandle</span><span style="color: #000066;">;</span>
  DocInfo<span style="color: #000066;">:</span> TDocInfo1<span style="color: #000066;">;</span>
  i<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Integer</span><span style="color: #000066;">;</span>
  B<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Byte</span><span style="color: #000066;">;</span>
  Escritos<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">DWORD</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  Result<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #000000; font-weight: bold;">FALSE</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">if</span> OpenPrinter<span style="color: #000066;">(</span><span style="color: #000066; font-weight: bold;">PChar</span><span style="color: #000066;">(</span>PrinterName<span style="color: #000066;">)</span><span style="color: #000066;">,</span> PrinterHandle<span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">nil</span><span style="color: #000066;">)</span> <span style="color: #000000; font-weight: bold;">then</span>
  <span style="color: #000000; font-weight: bold;">try</span>
    <span style="color: #000066;">FillChar</span><span style="color: #000066;">(</span>DocInfo<span style="color: #000066;">,</span><span style="color: #000066;">Sizeof</span><span style="color: #000066;">(</span>DocInfo<span style="color: #000066;">)</span><span style="color: #000066;">,</span><span style="color: #ff0000;">#0</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">with</span> DocInfo <span style="color: #000000; font-weight: bold;">do</span>
    <span style="color: #000000; font-weight: bold;">begin</span>
      pDocName<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #000066; font-weight: bold;">PChar</span><span style="color: #000066;">(</span><span style="color: #ff0000;">'rawprint'</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
      pOutputFile<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #000000; font-weight: bold;">nil</span><span style="color: #000066;">;</span>
      pDataType<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #ff0000;">'RAW'</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">if</span> StartDocPrinter<span style="color: #000066;">(</span>PrinterHandle<span style="color: #000066;">,</span> <span style="color: #0000ff;">1</span><span style="color: #000066;">,</span> <span style="color: #000066;">@</span>DocInfo<span style="color: #000066;">)</span> &lt;&gt; <span style="color: #0000ff;">0</span> <span style="color: #000000; font-weight: bold;">then</span>
    <span style="color: #000000; font-weight: bold;">try</span>
      <span style="color: #000000; font-weight: bold;">if</span> StartPagePrinter<span style="color: #000066;">(</span>PrinterHandle<span style="color: #000066;">)</span> <span style="color: #000000; font-weight: bold;">then</span>
      <span style="color: #000000; font-weight: bold;">try</span>
        <span style="color: #000000; font-weight: bold;">while</span> <span style="color: #000066;">Length</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">)</span> &gt; <span style="color: #0000ff;">0</span> <span style="color: #000000; font-weight: bold;">do</span>
        <span style="color: #000000; font-weight: bold;">begin</span>
          <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #000066;">Copy</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">,</span> <span style="color: #0000ff;">1</span><span style="color: #000066;">,</span> <span style="color: #0000ff;">1</span><span style="color: #000066;">)</span> <span style="color: #000066;">=</span> <span style="color: #ff0000;">'\'</span> <span style="color: #000000; font-weight: bold;">then</span>
          <span style="color: #000000; font-weight: bold;">begin</span>
            <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #000066;">Uppercase</span><span style="color: #000066;">(</span><span style="color: #000066;">Copy</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">,</span> <span style="color: #0000ff;">2</span><span style="color: #000066;">,</span> <span style="color: #0000ff;">1</span><span style="color: #000066;">)</span><span style="color: #000066;">)</span> <span style="color: #000066;">=</span> <span style="color: #ff0000;">'X'</span> <span style="color: #000000; font-weight: bold;">then</span>
              Str<span style="color: #000066;">[</span><span style="color: #0000ff;">2</span><span style="color: #000066;">]</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #ff0000;">'$'</span><span style="color: #000066;">;</span>
            <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #000000; font-weight: bold;">not</span> <span style="color: #000066;">TryStrToInt</span><span style="color: #000066;">(</span><span style="color: #000066;">Copy</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">,</span> <span style="color: #0000ff;">2</span><span style="color: #000066;">,</span> <span style="color: #0000ff;">3</span><span style="color: #000066;">)</span><span style="color: #000066;">,</span>i<span style="color: #000066;">)</span> <span style="color: #000000; font-weight: bold;">then</span>
              Exit<span style="color: #000066;">;</span>
            B<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #000066; font-weight: bold;">Byte</span><span style="color: #000066;">(</span>i<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
            <span style="color: #000066;">Delete</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">,</span> <span style="color: #0000ff;">1</span><span style="color: #000066;">,</span> <span style="color: #0000ff;">3</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
          <span style="color: #000000; font-weight: bold;">end</span> <span style="color: #000000; font-weight: bold;">else</span> B<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #000066; font-weight: bold;">Byte</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">[</span><span style="color: #0000ff;">1</span><span style="color: #000066;">]</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
          <span style="color: #000066;">Delete</span><span style="color: #000066;">(</span>Str<span style="color: #000066;">,</span><span style="color: #0000ff;">1</span><span style="color: #000066;">,</span><span style="color: #0000ff;">1</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
          WritePrinter<span style="color: #000066;">(</span>PrinterHandle<span style="color: #000066;">,</span> <span style="color: #000066;">@</span>B<span style="color: #000066;">,</span> <span style="color: #0000ff;">1</span><span style="color: #000066;">,</span> Escritos<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
        <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
        Result<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #000000; font-weight: bold;">TRUE</span><span style="color: #000066;">;</span>
      <span style="color: #000000; font-weight: bold;">finally</span>
        EndPagePrinter<span style="color: #000066;">(</span>PrinterHandle<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
      <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">finally</span>
      EndDocPrinter<span style="color: #000066;">(</span>PrinterHandle<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">finally</span>
    ClosePrinter<span style="color: #000066;">(</span>PrinterHandle<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">begin</span>
  <span style="color: #000000; font-weight: bold;">if</span> ParamCount <span style="color: #000066;">=</span> <span style="color: #0000ff;">2</span> <span style="color: #000000; font-weight: bold;">then</span>
    WriteRawDataToPrinter<span style="color: #000066;">(</span><span style="color: #000066;">ParamStr</span><span style="color: #000066;">(</span><span style="color: #0000ff;">1</span><span style="color: #000066;">)</span><span style="color: #000066;">,</span><span style="color: #000066;">ParamStr</span><span style="color: #000066;">(</span><span style="color: #0000ff;">2</span><span style="color: #000066;">)</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">.</span></pre></div>
<p>Espero que te sirva de ayuda.</p>
<p>Saludos</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>

<div class="indented"><a id="comment-992"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/992#comment-992" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/992#comment-992" class="permalink" rel="bookmark">Solo quería que supieras que</a></h3>
  
  <div class="submitted">
    <a href="/comment/992#comment-992" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2013-04-16T02:54:13+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Rodrigo López (no verificado)</span> el Mar, 04/16/2013 - 02:54</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><span rel="sioc:reply_of" resource="/comment/987#comment-987" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Solo quería que supieras que pude hacer lo que necesitaba.<br />
Muchísimas gracias por compartir y ayudar a los que sabemos menos.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
</div></div><a id="comment-988"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/988#comment-988" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/988#comment-988" class="permalink" rel="bookmark">que codigo tendria que</a></h3>
  
  <div class="submitted">
    <a href="/comment/988#comment-988" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2013-03-20T12:46:27+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Manuel (no verificado)</span> el Mié, 03/20/2013 - 12:46</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>que codigo tendria que utilizar en el printext para seleccionar un logo almacenado en mi impresora epson tm88v</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>

<div class="indented"><a id="comment-991"></a>
<div class="comment comment-by-node-author clearfix" about="/comment/991#comment-991" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/991#comment-991" class="permalink" rel="bookmark">Prueba con esto:</a></h3>
  
  <div class="submitted">
    <a href="/comment/991#comment-991" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2013-03-20T21:23:10+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" about="/user/1" typeof="sioc:UserAccount" property="foaf:name" datatype="">admin</span> el Mié, 03/20/2013 - 21:23</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><span rel="sioc:reply_of" resource="/comment/988#comment-988" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Prueba con esto:</p>
<div class="geshifilter">
<pre class="text geshifilter-text" style="font-family:monospace;">\x1C\x70\x01\x00</pre></div>
<p>Puede que tengas que incluir la secuencia de inicio y un avance de linea:</p>
<div class="geshifilter">
<pre class="text geshifilter-text" style="font-family:monospace;">\x1B@\x1C\x70\x01\x00\x0\x0A\x0D</pre></div>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
</div><a id="comment-1003"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/1003#comment-1003" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/1003#comment-1003" class="permalink" rel="bookmark">buen aporte lo acabo de calar</a></h3>
  
  <div class="submitted">
    <a href="/comment/1003#comment-1003" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2013-06-20T04:52:36+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">jose R (no verificado)</span> el Jue, 06/20/2013 - 04:52</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>buen aporte lo acabo de calar en win7 de 64 bits y jalo.... bien, en una impresora Zebra ZM600, nada mas tengo que adecuarlo a mi programa y listo.... gracias  Seoane</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
<a id="comment-1047"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/1047#comment-1047" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/1047#comment-1047" class="permalink" rel="bookmark">Se agradece el ejemplo que</a></h3>
  
  <div class="submitted">
    <a href="/comment/1047#comment-1047" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2014-01-12T02:18:39+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">El Rayo (no verificado)</span> el Dom, 01/12/2014 - 02:18</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Se agradece el ejemplo que pusiste. Me fue de utilidad para hacer una impresión en una EPSON TM-C3400.</p>
<p>Lo único que no entendí fue para que usas la funcion PrinterLine. Dime si es que la usas para digujar una línea y asi hacer más comodo el uso de las otras dos funciones que incluye.</p>
<p>Comento por si a alguno le interesa. La impresora mensionada no usa fuentes propias, sino las que tenga instaladas Windows. Si se quiere imprimir un código de barras lo unico que se tiene que hacer es llamar a la fuente correspondiente para generar el código y mandar a imprimir el texto que debe generar este código de barras.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>

<div class="indented"><a id="comment-1048"></a>
<div class="comment comment-by-node-author clearfix" about="/comment/1048#comment-1048" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/1048#comment-1048" class="permalink" rel="bookmark">Exacto &quot;PrinterLine&quot; es un</a></h3>
  
  <div class="submitted">
    <a href="/comment/1048#comment-1048" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2014-01-12T02:23:18+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" about="/user/1" typeof="sioc:UserAccount" property="foaf:name" datatype="">admin</span> el Dom, 01/12/2014 - 02:23</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><span rel="sioc:reply_of" resource="/comment/1047#comment-1047" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Exacto "PrinterLine" es un atajo para las otras dos funciones.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
</div><a id="comment-1068"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/1068#comment-1068" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/1068#comment-1068" class="permalink" rel="bookmark">que codigo necesitaría para</a></h3>
  
  <div class="submitted">
    <a href="/comment/1068#comment-1068" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2014-03-28T11:53:01+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Alex Lopez (no verificado)</span> el Vie, 03/28/2014 - 11:53</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>que codigo necesitaría para abrir el cajón de dinero de una GP-U80300II??</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>

<div class="indented"><a id="comment-1071"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/1071#comment-1071" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/1071#comment-1071" class="permalink" rel="bookmark">Yo he probado en ena GP con</a></h3>
  
  <div class="submitted">
    <a href="/comment/1071#comment-1071" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2014-04-08T19:04:13+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <a href="http://www.coresapalma.es" rel="nofollow foaf:page" class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Luis (no verificado)</a> el Mar, 04/08/2014 - 19:04</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><span rel="sioc:reply_of" resource="/comment/1068#comment-1068" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Yo he probado en ena GP con<br />
\x1B@\x0A\x0D\027\112\000\100\250\x0A\x0D<br />
y funciona (quizá se pueda eliminar el salto de línea final \x0A\x0D</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
</div><a id="comment-1074"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/1074#comment-1074" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/1074#comment-1074" class="permalink" rel="bookmark">Buena Tarde. tengo una</a></h3>
  
  <div class="submitted">
    <a href="/comment/1074#comment-1074" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2014-04-25T02:23:54+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Beatriz (no verificado)</span> el Vie, 04/25/2014 - 02:23</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Buena Tarde. tengo una impresora QL-700. ya realice varios intentos, inclusive este ejemplo y al mandar a imprimir me marca error de comunicación entre el PC y la Brother QL. Lo extraño es que desde el software que trae &quot;PTLITE10&quot; si puedo imprimir etiquetas sin problema. Espero me puedan Apoyar. de antemano gracias.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
<a id="comment-1078"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/1078#comment-1078" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/1078#comment-1078" class="permalink" rel="bookmark">una consulta, en base a su</a></h3>
  
  <div class="submitted">
    <a href="/comment/1078#comment-1078" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2014-06-10T00:38:45+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">marco amusquivar (no verificado)</span> el Mar, 06/10/2014 - 00:38</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/50" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>una consulta, en base a su código me encuentro imprimiendo a la perfección mis facturas pero ahora necesito incluir código qr al final, sera que me pueda dar alguna pista ?</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>

  </div>
</article>

</section>
  </div>
    </section>

    
  </div>
</div>

  <footer class="footer container">
      <div class="region region-footer">
    <section id="block-menu-menu-enlaces" class="block block-menu clearfix">

        <h2 class="block-title">Enlaces interesantes</h2>
    
  <ul class="menu nav"><li class="first leaf"><a href="http://www.cadetill.com" title="">Cadetill</a></li>
<li class="leaf"><a href="http://www.delphiaccess.com/forum" title="">DelphiAccess</a></li>
<li class="leaf"><a href="http://www.delphispano.com/" title="">Delphispano</a></li>
<li class="leaf"><a href="http://egostar.delphiaccess.com/" title="">Egostar</a></li>
<li class="leaf"><a href="http://jachguate.wordpress.com/" title="">Jachguate</a></li>
<li class="leaf"><a href="http://neftali.clubdelphi.com/" title="">Neftali</a></li>
<li class="leaf"><a href="http://elpoli.delphiaccess.com/" title="">Poliburro</a></li>
<li class="leaf"><a href="http://theroadtodelphi.wordpress.com/" title="">Rodrigo Ruz</a></li>
<li class="last leaf"><a href="http://salvador.oversistemas.com/" title="">Salvador Gomez</a></li>
</ul>
</section>
<section id="block-block-1" class="block block-block clearfix">

      
  <p>copyright (c) 2007 - 2016 Domingo Seoane</p>

</section>
  </div>
  </footer>
  <script src="/sites/delphi.jmrds.com/themes/bootstrap/js/bootstrap.js?"></script>
</body>
</html>
