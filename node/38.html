<!DOCTYPE html>
<html lang="es" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ og: http://ogp.me/ns# rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema#">
<head>
  <link rel="profile" href="http://www.w3.org/1999/xhtml/vocab" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/sites/delphi.jmrds.com/themes/bootstrap/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="shortlink" href="/node/38" />
<link rel="canonical" href="/node/38" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
  <title>Obtener handle de una ventana a partir del PID de un proceso | La web de Seoane</title>
  <style>
@import url("/modules/system/system.base.css?");
</style>
<style>
@import url("/modules/field/theme/field.css?");
@import url("/modules/node/node.css?");
</style>
<style>
@import url("/sites/delphi.jmrds.com/modules/geshifilter/geshifilter.css?");
</style>
<link type="text/css" rel="stylesheet" href="/sites/delphi.jmrds.com/themes/bootstrap/bootstrap.css" media="all" />
<style>
@import url("/sites/delphi.jmrds.com/themes/bootstrap/css/3.3.5/overrides.min.css?");
</style>
  <!-- HTML5 element support for IE6-8 -->
  <!--[if lt IE 9]>
    <script src="https://cdn.jsdelivr.net/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <script src="/sites/delphi.jmrds.com/modules/jquery_update/replace/jquery/1.10/jquery.min.js?v=1.10.2"></script>
<script src="/misc/jquery.once.js?v=1.2"></script>
<script src="/misc/drupal.js?"></script>
<script src="/sites/delphi.jmrds.com/themes/bootstrap/bootstrap.js"></script>
<script src="/sites/delphi.jmrds.com/files/languages/es_sB9mP1iixuFRbyZKZVySK7xrSW_2-LRj1vNEXyqwOu8.js?"></script>
<script>jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"bootstrap","theme_token":"DrZv9IBNHA_SbH3EkEiKt4jdvVdm1cR0a5gZ2w3tAYM","js":{"sites\/delphi.jmrds.com\/themes\/bootstrap\/js\/bootstrap.js":1,"sites\/delphi.jmrds.com\/modules\/jquery_update\/replace\/jquery\/1.10\/jquery.min.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"\/\/cdn.jsdelivr.net\/bootstrap\/3.3.5\/js\/bootstrap.js":1,"public:\/\/languages\/es_sB9mP1iixuFRbyZKZVySK7xrSW_2-LRj1vNEXyqwOu8.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"sites\/delphi.jmrds.com\/modules\/geshifilter\/geshifilter.css":1,"\/\/cdn.jsdelivr.net\/bootstrap\/3.3.5\/css\/bootstrap.css":1,"sites\/delphi.jmrds.com\/themes\/bootstrap\/css\/3.3.5\/overrides.min.css":1}},"bootstrap":{"anchorsFix":"0","anchorsSmoothScrolling":"0","formHasError":1,"popoverEnabled":"1","popoverOptions":{"animation":1,"html":0,"placement":"right","selector":"","trigger":"click","triggerAutoclose":1,"title":"","content":"","delay":0,"container":"body"},"tooltipEnabled":"1","tooltipOptions":{"animation":1,"html":0,"placement":"auto left","selector":"","trigger":"hover focus","delay":0,"container":"body"}}});</script>
</head>
<body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-38 node-type-article">
  <div id="skip-link">
    <a href="#main-content" class="element-invisible element-focusable">Pasar al contenido principal</a>
  </div>
    <header id="navbar" role="banner" class="navbar container navbar-default">
  <div class="container">
    <div class="navbar-header">
              <a class="logo navbar-btn pull-left" href="/" title="Inicio">
          <img src="/sites/delphi.jmrds.com/themes/bootstrap/logo.png" alt="Inicio" />
        </a>
      
              <a class="name navbar-brand" href="/" title="Inicio">La web de Seoane</a>
      
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
          </div>

          <div class="navbar-collapse collapse" id="navbar-collapse">
        <nav role="navigation">
                      <ul class="menu nav navbar-nav"><li class="first leaf"><a href="/" title="">Inicio</a></li>
<li class="last leaf"><a href="/node/26" title="">Contacto</a></li>
</ul>                                      </nav>
      </div>
      </div>
</header>

<div class="main-container container">

  <header role="banner" id="page-header">
    
      </header> <!-- /#page-header -->

  <div class="row">

    
    <section class="col-sm-12">
                  <a id="main-content"></a>
                    <h1 class="page-header">Obtener handle de una ventana a partir del PID de un proceso</h1>
                                                          <div class="region region-content">
    <section id="block-system-main" class="block block-system clearfix">

      
  <article id="node-38" class="node node-article node-promoted clearfix" about="/node/38" typeof="sioc:Item foaf:Document">
    <header>
            <span property="dc:title" content="Obtener handle de una ventana a partir del PID de un proceso" class="rdf-meta element-hidden"></span><span property="sioc:num_replies" content="2" datatype="xsd:integer" class="rdf-meta element-hidden"></span>        <span class="submitted">
            <span property="dc:date dc:created" content="2007-08-24T01:48:52+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" about="/user/1" typeof="sioc:UserAccount" property="foaf:name" datatype="">admin</span> el Vie, 08/24/2007 - 01:48</span>    </span>
      </header>
    <div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Para encontrar el handle de una ventana, existen ya funciones como FindWindow, que permite encontrar una ventana conociendo su título, pero seria interesante poder limitar la búsqueda a las ventanas de un proceso determinado. Esto es lo que hace la función siguiente, encuentra el handle de una ventana, pasándole como parámetro el PID del proceso al que pertenece y opcionalmente el título de la ventana.</p>
<!--break--><div class="geshifilter">
<pre class="delphi geshifilter-delphi" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">type</span>
  TWindowRec <span style="color: #000066;">=</span> <span style="color: #000000; font-weight: bold;">record</span>
    Handle<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">THandle</span><span style="color: #000066;">;</span>
    ProcessId<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Cardinal</span><span style="color: #000066;">;</span>
    WindowName<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">PChar</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
  PWindowRec <span style="color: #000066;">=</span> <span style="color: #000066;">^</span>TWindowRec<span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">function</span> EnumWindowsProc<span style="color: #000066;">(</span>Handle<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Thandle</span><span style="color: #000066;">;</span> lParam<span style="color: #000066;">:</span> LPARAM<span style="color: #000066;">)</span><span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">BOOL</span><span style="color: #000066;">;</span> <span style="color: #000000; font-weight: bold;">stdcall</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">var</span>
  ProcessId<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Cardinal</span><span style="color: #000066;">;</span>
  Buffer<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">PChar</span><span style="color: #000066;">;</span>
  Size<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Integer</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  Result<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #000000; font-weight: bold;">TRUE</span><span style="color: #000066;">;</span>
  ProcessId<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #0000ff;">0</span><span style="color: #000066;">;</span>
  GetWindowThreadProcessId<span style="color: #000066;">(</span>Handle<span style="color: #000066;">,</span> ProcessId<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">if</span> ProcessId <span style="color: #000066;">=</span> PWindowRec<span style="color: #000066;">(</span>lParam<span style="color: #000066;">)</span><span style="color: #000066;">.</span><span style="color: #006600;">ProcessId</span> <span style="color: #000000; font-weight: bold;">then</span>
  <span style="color: #000000; font-weight: bold;">begin</span>
    <span style="color: #000000; font-weight: bold;">if</span> PWindowRec<span style="color: #000066;">(</span>lParam<span style="color: #000066;">)</span><span style="color: #000066;">.</span><span style="color: #006600;">WindowName</span> &lt;&gt; <span style="color: #000000; font-weight: bold;">nil</span> <span style="color: #000000; font-weight: bold;">then</span>
    <span style="color: #000000; font-weight: bold;">begin</span>
      Size<span style="color: #000066;">:</span><span style="color: #000066;">=</span> GetWindowTextLength<span style="color: #000066;">(</span>Handle<span style="color: #000066;">)</span> <span style="color: #000066;">+</span> <span style="color: #0000ff;">1</span><span style="color: #000066;">;</span>
      <span style="color: #000066;">GetMem</span><span style="color: #000066;">(</span>Buffer<span style="color: #000066;">,</span>Size<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
      <span style="color: #000000; font-weight: bold;">try</span>
        GetWindowText<span style="color: #000066;">(</span>Handle<span style="color: #000066;">,</span>Buffer<span style="color: #000066;">,</span>Size<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
        <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #000066;">StrIcomp</span><span style="color: #000066;">(</span>PWindowRec<span style="color: #000066;">(</span>lParam<span style="color: #000066;">)</span><span style="color: #000066;">.</span><span style="color: #006600;">WindowName</span><span style="color: #000066;">,</span> Buffer<span style="color: #000066;">)</span> <span style="color: #000066;">=</span> <span style="color: #0000ff;">0</span> <span style="color: #000000; font-weight: bold;">then</span>
        <span style="color: #000000; font-weight: bold;">begin</span>
          PWindowRec<span style="color: #000066;">(</span>lParam<span style="color: #000066;">)</span><span style="color: #000066;">.</span><span style="color: #006600;">Handle</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> Handle<span style="color: #000066;">;</span>
          Result<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #000000; font-weight: bold;">FALSE</span><span style="color: #000066;">;</span>
        <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
      <span style="color: #000000; font-weight: bold;">finally</span>
        <span style="color: #000066;">Freemem</span><span style="color: #000066;">(</span>Buffer<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
      <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">end</span> <span style="color: #000000; font-weight: bold;">else</span>
    <span style="color: #000000; font-weight: bold;">begin</span>
      PWindowRec<span style="color: #000066;">(</span>lParam<span style="color: #000066;">)</span><span style="color: #000066;">.</span><span style="color: #006600;">Handle</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> Handle<span style="color: #000066;">;</span>
      Result<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #000000; font-weight: bold;">FALSE</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">function</span> GetWindowFromProcessId<span style="color: #000066;">(</span>ProcessId<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Cardinal</span><span style="color: #000066;">;</span> WindowName<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">PChar</span><span style="color: #000066;">)</span><span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">THandle</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">var</span>
  WindowRec<span style="color: #000066;">:</span> TWindowRec<span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  <span style="color: #000066;">FillChar</span><span style="color: #000066;">(</span>WindowRec<span style="color: #000066;">,</span><span style="color: #000066;">Sizeof</span><span style="color: #000066;">(</span>WindowRec<span style="color: #000066;">)</span><span style="color: #000066;">,</span><span style="color: #0000ff;">0</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  WindowRec<span style="color: #000066;">.</span><span style="color: #006600;">ProcessId</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> ProcessId<span style="color: #000066;">;</span>
  WindowRec<span style="color: #000066;">.</span><span style="color: #006600;">WindowName</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> WindowName<span style="color: #000066;">;</span>
  EnumWindows<span style="color: #000066;">(</span><span style="color: #000066;">@</span>EnumWindowsProc<span style="color: #000066;">,</span> LPARAM<span style="color: #000066;">(</span><span style="color: #000066;">@</span>WindowRec<span style="color: #000066;">)</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  Result<span style="color: #000066;">:</span><span style="color: #000066;">=</span> WindowRec<span style="color: #000066;">.</span><span style="color: #006600;">Handle</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span></pre></div>
<p>La función anterior (GetWindowFromProcessId) nos devolverá el handle de la ventana que buscamos, o cero si no la encuentra. El parámetro WindowName es opcional, si es igual a nil, se devolverá el primer handle que se encuentre asociado a ese proceso. </p>
<p>Ahora solo necesitamos el PID del proceso, la siguiente función ejecuta un programa y usando su PID busca el handle de la ventana. El parámetro WindowName sigue siendo opcional, y el parámetro TimeOut indica el tiempo (en milisegundos) que hay que esperar a que el programa cree la ventana. Si la ventana se crea antes, la función volverá inmediatamente.</p>
<div class="geshifilter">
<pre class="delphi geshifilter-delphi" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">function</span> Ejecutar<span style="color: #000066;">(</span>Cmd<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">string</span><span style="color: #000066;">;</span> WindowName<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">PChar</span><span style="color: #000066;">;</span> Timeout<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Cardinal</span><span style="color: #000066;">)</span><span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">THandle</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">var</span>
  StartupInfo<span style="color: #000066;">:</span> TStartupInfo<span style="color: #000066;">;</span>
  ProcessInfo<span style="color: #000066;">:</span> TProcessInformation<span style="color: #000066;">;</span>
  Ticks<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">Cardinal</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  Result<span style="color: #000066;">:</span><span style="color: #000066;">=</span> <span style="color: #0000ff;">0</span><span style="color: #000066;">;</span>
  <span style="color: #000066;">FillChar</span><span style="color: #000066;">(</span>StartupInfo<span style="color: #000066;">,</span><span style="color: #000066;">Sizeof</span><span style="color: #000066;">(</span>StartupInfo<span style="color: #000066;">)</span><span style="color: #000066;">,</span><span style="color: #0000ff;">0</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  StartupInfo<span style="color: #000066;">.</span><span style="color: #006600;">wShowWindow</span><span style="color: #000066;">:</span><span style="color: #000066;">=</span> SW_SHOW<span style="color: #000066;">;</span>
  Ticks<span style="color: #000066;">:</span><span style="color: #000066;">=</span> GetTickCount<span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">if</span> CreateProcess<span style="color: #000066;">(</span><span style="color: #000000; font-weight: bold;">nil</span><span style="color: #000066;">,</span><span style="color: #000066; font-weight: bold;">PChar</span><span style="color: #000066;">(</span>Cmd<span style="color: #000066;">)</span><span style="color: #000066;">,</span><span style="color: #000000; font-weight: bold;">nil</span><span style="color: #000066;">,</span><span style="color: #000000; font-weight: bold;">nil</span><span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">FALSE</span><span style="color: #000066;">,</span> CREATE_NEW_CONSOLE <span style="color: #000000; font-weight: bold;">or</span>
    NORMAL_PRIORITY_CLASS<span style="color: #000066;">,</span><span style="color: #000000; font-weight: bold;">nil</span><span style="color: #000066;">,</span><span style="color: #000000; font-weight: bold;">nil</span><span style="color: #000066;">,</span>StartupInfo<span style="color: #000066;">,</span> ProcessInfo<span style="color: #000066;">)</span> <span style="color: #000000; font-weight: bold;">then</span>
    <span style="color: #000000; font-weight: bold;">while</span> <span style="color: #000066;">(</span>Result <span style="color: #000066;">=</span> <span style="color: #0000ff;">0</span><span style="color: #000066;">)</span> <span style="color: #000000; font-weight: bold;">and</span> <span style="color: #000066;">(</span>GetTickCount <span style="color: #000066;">-</span> Ticks &lt; TimeOut<span style="color: #000066;">)</span> <span style="color: #000000; font-weight: bold;">do</span>
    <span style="color: #000000; font-weight: bold;">begin</span>
      Result<span style="color: #000066;">:</span><span style="color: #000066;">=</span> GetWindowFromProcessId<span style="color: #000066;">(</span>ProcessInfo<span style="color: #000066;">.</span><span style="color: #006600;">dwProcessId</span><span style="color: #000066;">,</span> WindowName<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
      <span style="color: #000000; font-weight: bold;">if</span> Result <span style="color: #000066;">=</span> <span style="color: #0000ff;">0</span> <span style="color: #000000; font-weight: bold;">then</span> <span style="color: #000066;">Sleep</span><span style="color: #000066;">(</span><span style="color: #0000ff;">200</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span></pre></div>
<p>Un ejemplo de como usar todo lo anterior seria lo siguiente. Ejecutamos el notepad, obtenemos el handle de la ventana, la ponemos al frente, y le mandamos la tecla 'a'.</p>
<div class="geshifilter">
<pre class="delphi geshifilter-delphi" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">procedure</span> PonerDelante<span style="color: #000066;">(</span>Handle<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">THandle</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">var</span>
  FgThreadId  <span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">DWORD</span><span style="color: #000066;">;</span>
  AppThreadId <span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">DWORD</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  FgThreadId  <span style="color: #000066;">:</span><span style="color: #000066;">=</span> GetWindowThreadProcessId<span style="color: #000066;">(</span>GetForegroundWindow<span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">nil</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  AppThreadId <span style="color: #000066;">:</span><span style="color: #000066;">=</span> GetWindowThreadProcessId<span style="color: #000066;">(</span>Handle<span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">nil</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  AttachThreadInput<span style="color: #000066;">(</span>AppThreadId<span style="color: #000066;">,</span> FgThreadId<span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">true</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  SetForegroundWindow<span style="color: #000066;">(</span>Handle<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  AttachThreadInput<span style="color: #000066;">(</span>AppThreadId<span style="color: #000066;">,</span> FgThreadId<span style="color: #000066;">,</span> <span style="color: #000000; font-weight: bold;">false</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
 
<span style="color: #000000; font-weight: bold;">var</span>
  H<span style="color: #000066;">:</span> <span style="color: #000066; font-weight: bold;">THandle</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  <span style="color: #808080; font-style: italic;">// Obtenemos el Handle de la ventana</span>
  H<span style="color: #000066;">:</span><span style="color: #000066;">=</span> Ejecutar<span style="color: #000066;">(</span><span style="color: #ff0000;">'Notepad'</span><span style="color: #000066;">,</span><span style="color: #000000; font-weight: bold;">nil</span><span style="color: #000066;">,</span><span style="color: #0000ff;">5000</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">if</span> H &lt;&gt; <span style="color: #0000ff;">0</span> <span style="color: #000000; font-weight: bold;">then</span>
  <span style="color: #000000; font-weight: bold;">begin</span>
    <span style="color: #808080; font-style: italic;">// La ponemos por delante</span>
    PonerDelante<span style="color: #000066;">(</span>H<span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    <span style="color: #808080; font-style: italic;">// Le mandamos la letra 'a'</span>
    keybd_event<span style="color: #000066;">(</span><span style="color: #0000cc;">$41</span><span style="color: #000066;">,</span> <span style="color: #0000ff;">0</span><span style="color: #000066;">,</span> <span style="color: #0000ff;">0</span><span style="color: #000066;">,</span> <span style="color: #0000ff;">0</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
    keybd_event<span style="color: #000066;">(</span><span style="color: #0000cc;">$41</span><span style="color: #000066;">,</span> <span style="color: #0000ff;">0</span><span style="color: #000066;">,</span> KEYEVENTF_KEYUP<span style="color: #000066;">,</span> <span style="color: #0000ff;">0</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
  <span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">end</span><span style="color: #000066;">;</span></pre></div>
</div></div></div>    <footer>
        <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul>  </footer>
    <div id="comments" class="comment-wrapper">
          <h2 class="title">Comentarios</h2>
      
  <a id="comment-12"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/12#comment-12" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/12#comment-12" class="permalink" rel="bookmark">Domingo, estoy seguro que</a></h3>
  
  <div class="submitted">
    <a href="/comment/12#comment-12" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2007-09-01T05:35:05+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">dec (no verificado)</span> el Sáb, 09/01/2007 - 05:35</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/38" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Domingo, estoy seguro que funciona, pero, cuando escribes:</p>
<div class="geshifilter">
<pre class="delphi geshifilter-delphi" style="font-family:monospace;"><span style="color: #000066;">FillChar</span><span style="color: #000066;">(</span>WindowRec<span style="color: #000066;">,</span><span style="color: #000066;">Sizeof</span><span style="color: #000066;">(</span>WindowRec<span style="color: #000066;">)</span><span style="color: #000066;">,</span><span style="color: #0000ff;">0</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #808080; font-style: italic;">// O también</span>
<span style="color: #000066;">FillChar</span><span style="color: #000066;">(</span>StartupInfo<span style="color: #000066;">,</span><span style="color: #000066;">Sizeof</span><span style="color: #000066;">(</span>StartupInfo<span style="color: #000066;">)</span><span style="color: #000066;">,</span><span style="color: #0000ff;">0</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span></pre></div>
<p>¿No debería ser de este otro modo?</p>
<div class="geshifilter">
<pre class="delphi geshifilter-delphi" style="font-family:monospace;"><span style="color: #000066;">FillChar</span><span style="color: #000066;">(</span>WindowRec<span style="color: #000066;">,</span><span style="color: #000066;">Sizeof</span><span style="color: #000066;">(</span>TWindowRec<span style="color: #000066;">)</span><span style="color: #000066;">,</span><span style="color: #0000ff;">0</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span>
<span style="color: #808080; font-style: italic;">// Y también</span>
<span style="color: #000066;">FillChar</span><span style="color: #000066;">(</span>StartupInfo<span style="color: #000066;">,</span><span style="color: #000066;">Sizeof</span><span style="color: #000066;">(</span>TStartupInfo<span style="color: #000066;">)</span><span style="color: #000066;">,</span><span style="color: #0000ff;">0</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span></pre></div>
<p>Me ha extrañado, más que nada, porque creo haberlo visto también como digo... pero estoy seguro de que algo se me escapa y tal vez pueda escribirse de ambas formas... o que sea más "correcto" como lo haces tú.</p>
<p>¿Puedes explicárnoslo a los ignorantes como yo? Gracias. :)</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>
<a id="comment-13"></a>
<div class="comment comment-by-node-author clearfix" about="/comment/13#comment-13" typeof="sioc:Post sioct:Comment">
  
  
    <h3 property="dc:title" datatype=""><a href="/comment/13#comment-13" class="permalink" rel="bookmark">Pues dec, se puede utilizar</a></h3>
  
  <div class="submitted">
    <a href="/comment/13#comment-13" class="permalink" rel="bookmark">Enlace permanente</a>    <span property="dc:date dc:created" content="2007-09-01T12:18:11+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Enviado por <span class="username" xml:lang="" about="/user/1" typeof="sioc:UserAccount" property="foaf:name" datatype="">admin</span> el Sáb, 09/01/2007 - 12:18</span>  </div>

  <div class="content">
    <span rel="sioc:reply_of" resource="/node/38" class="rdf-meta element-hidden"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Pues dec, se puede utilizar de ambas maneras. De la manera que lo hago yo, <b>Sizeof</b> devuelve el tamaño que ocupa esa variable, mientras que si colocas el tipo, <b>Sizeof</b> devuelve el tamaño que ocuparía una variable de ese tipo. En este caso da igual que forma usemos, pero yo estoy acostumbrado a usar la primera porque si cambio el tipo de la variable no me tengo que estar preocupando de cambiar todas las sentencias <b>Sizeof</b> que hacen referencia a esa variable.</p>
<p>Otro caso distinto seria el siguiente:</p>
<div class="geshifilter">
<pre class="delphi geshifilter-delphi" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">var</span>
  Prueba<span style="color: #000066;">:</span> PWindowRec<span style="color: #000066;">;</span>
<span style="color: #000000; font-weight: bold;">begin</span>
  <span style="color: #000066;">GetMem</span><span style="color: #000066;">(</span>Prueba<span style="color: #000066;">,</span><span style="color: #000066;">Sizeof</span><span style="color: #000066;">(</span>TWindowRec<span style="color: #000066;">)</span><span style="color: #000066;">)</span><span style="color: #000066;">;</span></pre></div>
<p>Aquí si que no queda mas remedio que usar el tipo, ya que la variable es un puntero y no queremos saber su tamaño (normalmente solo 4 bytes) si no el tamaño de la variable a la que apunta.</p>
</div></div></div>      </div>

  <ul class="links list-inline"><li class="comment_forbidden first last"></li>
</ul></div>

  </div>
</article>

</section>
  </div>
    </section>

    
  </div>
</div>

  <script src="/sites/delphi.jmrds.com/themes/bootstrap/js/bootstrap.js?"></script>
</body>
</html>
